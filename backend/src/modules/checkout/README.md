# ูุธุงู ุงูุทูุจุงุช ูุงูุฏูุน ุงูููุญุฏ

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ููุญุฏ ุงุญุชุฑุงูู ูุฅุฏุงุฑุฉ ุงูุทูุจุงุช ูุงูุฏูุนุ ูููุฑ:
- ุฅุฏุงุฑุฉ ุดุงููุฉ ูุญุงูุงุช ุงูุทูุจุงุช
- ูุธุงู ุฏูุน ูุชูุงูู
- ุชุชุจุน ุงูุทูุจุงุช ูู ุงูููุช ุงููุนูู
- ุชุญูููุงุช ูุฅุญุตุงุฆูุงุช ูุชูุฏูุฉ
- ูุงุฌูุงุช API ููุญุฏุฉ

## ๐๏ธ ุงููููู ุงูููุญุฏ

```
checkout/
โโโ schemas/
โ   โโโ order.schema.ts          # Schema ููุญุฏ ููุทูุจุงุช
โ   โโโ inventory.schema.ts      # ุฅุฏุงุฑุฉ ุงููุฎุฒูู
โ   โโโ reservation.schema.ts    # ุญุฌุฒ ุงูููุชุฌุงุช
โ   โโโ inventory-ledger.schema.ts # ุณุฌู ุงููุฎุฒูู
โโโ services/
โ   โโโ order.service.ts          # ุฎุฏูุฉ ููุญุฏุฉ ููุทูุจุงุช
โโโ controllers/
โ   โโโ order.controller.ts       # Controller ููุนููุงุก
โ   โโโ admin-order.controller.ts # Controller ููุฅุฏุงุฑุฉ
โ   โโโ webhook.controller.ts     # Controller ููู Webhooks
โโโ dto/
โ   โโโ order.dto.ts             # DTOs ููุญุฏุฉ
โโโ utils/
โ   โโโ order-state-machine.ts   # State Machine ููุทูุจุงุช
โโโ checkout.module.ts           # Module ููุญุฏ
```

## ๐ ุญุงูุงุช ุงูุทูุจุงุช (OrderStatus) - ูุจุณุท

### ุงููุณุงุฑ ุงูุฃุณุงุณู
- `PENDING_PAYMENT` - ูู ุงูุชุธุงุฑ ุงูุฏูุน
- `CONFIRMED` - ูุคูุฏ ููุฏููุน
- `PROCESSING` - ููุฏ ุงูุชุฌููุฒ
- `COMPLETED` - ููุชูู

### ุญุงูุงุช ุงุณุชุซูุงุฆูุฉ
- `ON_HOLD` - ูุนูู
- `CANCELLED` - ููุบู
- `RETURNED` - ูุฑุชุฌุน
- `REFUNDED` - ูุณุชุฑุฏ

## ๐ณ ุญุงูุงุช ุงูุฏูุน (PaymentStatus)

- `PENDING` - ูู ุงูุงูุชุธุงุฑ
- `AUTHORIZED` - ูุฎูู
- `PAID` - ูุฏููุน
- `FAILED` - ูุดู
- `REFUNDED` - ูุณุชุฑุฏ
- `PARTIALLY_REFUNDED` - ูุณุชุฑุฏ ุฌุฒุฆูุงู
- `CANCELLED` - ููุบู

## ๐ ุทุฑู ุงูุดุญู (ShippingMethod)

- `STANDARD` - ุนุงุฏู
- `EXPRESS` - ุณุฑูุน
- `SAME_DAY` - ููุณ ุงูููู
- `PICKUP` - ุงุณุชูุงู ุดุฎุตู

## ๐ฐ ุทุฑู ุงูุฏูุน (PaymentMethod) - ูุจุณุท

- `COD` - ุงูุฏูุน ุนูุฏ ุงูุงุณุชูุงู
- `BANK_TRANSFER` - ุชุญููู ุจููู ูุญูู

## ๐ง State Machine - ูุจุณุท

ูุธุงู ุฅุฏุงุฑุฉ ุญุงูุงุช ูุจุณุท ูุถูู:
- ุงูุชูุงูุงุช ุตุญูุญุฉ ุจูู ุงูุญุงูุงุช
- ุงูุชุญูู ูู ุงูุตูุงุญูุงุช
- ููุน ุงูุงูุชูุงูุงุช ุบูุฑ ุงููุณููุญุฉ
- ุชุชุจุน ุชุงุฑูุฎ ุงูุชุบููุฑุงุช

### ุงููุณุงุฑ ุงูุฃุณุงุณู:
`PENDING_PAYMENT โ CONFIRMED โ PROCESSING โ COMPLETED`

### ูุซุงู ุนูู ุงูุงุณุชุฎุฏุงู:

```typescript
import { OrderStateMachine } from './utils/order-state-machine';

// ุงูุชุญูู ูู ุฅููุงููุฉ ุงูุงูุชูุงู
const canTransition = OrderStateMachine.canTransition(
  OrderStatus.PENDING_PAYMENT, 
  OrderStatus.CONFIRMED
);

// ุงูุญุตูู ุนูู ุงูุญุงูุงุช ุงูุชุงููุฉ
const nextStates = OrderStateMachine.getNextStates(OrderStatus.PROCESSING);

// ุงูุชุญูู ูู ุฅููุงููุฉ ุงูุฅูุบุงุก
const canCancel = OrderStateMachine.canCancel(OrderStatus.CONFIRMED);
```

**ููุงุญุธุฉ ูููุฉ:** ุชู ุชูุญูุฏ `OrderStateMachine` ูู `utils/order-state-machine.ts` ููุท. ุงุณุชุฎุฏู ุฏุงุฆูุงู:
```typescript
import { OrderStateMachine } from '../utils/order-state-machine';
```

## ๐ก API Endpoints

### ููุนููุงุก (`/orders`) - 9 endpoints

#### Checkout
- `POST /orders/checkout/preview` - ูุนุงููุฉ ุงูุทูุจ
- `POST /orders/checkout/confirm` - ุชุฃููุฏ ุงูุทูุจ

#### ุฅุฏุงุฑุฉ ุงูุทูุจุงุช
- `GET /orders` - ูุงุฆูุฉ ุงูุทูุจุงุช
- `GET /orders/recent` - ุงูุทูุจุงุช ุงูุฃุฎูุฑุฉ
- `GET /orders/:id` - ุชูุงุตูู ุงูุทูุจ
- `GET /orders/:id/track` - ุชุชุจุน ุงูุทูุจ
- `POST /orders/:id/cancel` - ุฅูุบุงุก ุงูุทูุจ
- `POST /orders/:id/rate` - ุชูููู ุงูุทูุจ
- `POST /orders/:id/notes` - ุฅุถุงูุฉ ููุงุญุธุงุช

#### ุงูุฅุญุตุงุฆูุงุช
- `GET /orders/stats/summary` - ุฅุญุตุงุฆูุงุช ุงููุณุชุฎุฏู

### ููุฅุฏุงุฑุฉ (`/admin/orders`) - 12 endpoints

#### ุฅุฏุงุฑุฉ ุงูุทูุจุงุช
- `GET /admin/orders` - ุฌููุน ุงูุทูุจุงุช
- `GET /admin/orders/:id` - ุชูุงุตูู ุงูุทูุจ
- `PATCH /admin/orders/:id/status` - ุชุญุฏูุซ ุงูุญุงูุฉ
- `POST /admin/orders/:id/ship` - ุดุญู ุงูุทูุจ
- `POST /admin/orders/:id/refund` - ูุนุงูุฌุฉ ุงูุงุณุชุฑุฏุงุฏ
- `POST /admin/orders/:id/notes` - ููุงุญุธุงุช ุฅุฏุงุฑูุฉ

#### ุงูุนูููุงุช ุงููุฌูุนุฉ
- `POST /admin/orders/bulk/update-status` - ุชุญุฏูุซ ุนุฏุฉ ุทูุจุงุช

#### ุงูุชุญูููุงุช
- `GET /admin/orders/analytics/summary` - ุชุญูููุงุช ุดุงููุฉ
- `GET /admin/orders/analytics/revenue` - ุชุญููู ุงูุฅูุฑุงุฏุงุช
- `GET /admin/orders/analytics/performance` - ุชุญููู ุงูุฃุฏุงุก

#### ุงูุชูุงุฑูุฑ
- `GET /admin/orders/reports/orders` - ุชูุฑูุฑ ุงูุทูุจุงุช
- `GET /admin/orders/reports/financial` - ุงูุชูุฑูุฑ ุงููุงูู

### Webhooks (`/webhooks`)

- `POST /webhooks/payment` - ุฅุดุนุงุฑุงุช ุงูุฏูุน
- `POST /webhooks/shipping` - ุฅุดุนุงุฑุงุช ุงูุดุญู
- `POST /webhooks/inventory` - ุฅุดุนุงุฑุงุช ุงููุฎุฒูู

## ๐ ุงูููุฒุงุช ุงููุชูุฏูุฉ

### 1. ุชุชุจุน ุงูุทูุจุงุช
- ุฎุท ุฒููู ุชูุงุนูู
- ุชุญุฏูุซุงุช ูู ุงูููุช ุงููุนูู
- ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ

### 2. ุฅุฏุงุฑุฉ ุงููุฎุฒูู
- ุญุฌุฒ ุชููุงุฆู ููููุชุฌุงุช
- ุชุชุจุน ุงููุฎุฒูู ุงููุชุงุญ
- ุชูุจููุงุช ููุงุฏ ุงููุฎุฒูู

### 3. ุงูุชุญูููุงุช ุงููุชูุฏูุฉ
- ุฅุญุตุงุฆูุงุช ุดุงููุฉ
- ุชุญููู ุงูุฅูุฑุงุฏุงุช
- ุชูุงุฑูุฑ ุงูุฃุฏุงุก
- ุชุญููู ุณููู ุงูุนููุงุก

### 4. ุงูุฃูุงู
- ุชุดููุฑ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ
- ุงูุชุญูู ูู ุงูุชูููุนุงุช
- ุชุณุฌูู ุฌููุน ุงูุนูููุงุช

## ๐ง ุงูุชูููู

### ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุงููุทููุจุฉ:

```env
# ุฅุนุฏุงุฏุงุช ุงูุญุฌุฒ
RESERVATION_TTL_SECONDS=900

# ููุชุงุญ ุชูููุน ุงูุฏูุน
PAYMENT_SIGNING_KEY=your_signing_key

# ุฅุนุฏุงุฏุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช
MONGODB_URI=mongodb://localhost:27017/tagadodo
```

## ๐ ุงูุงุณุชุฎุฏุงู

### 1. ุงุณุชูุฑุงุฏ ุงูู Module:

```typescript
import { CheckoutModule } from './modules/checkout/checkout.module';

@Module({
  imports: [CheckoutModule],
})
export class AppModule {}
```

### 2. ุงุณุชุฎุฏุงู ุงูุฎุฏูุฉ:

```typescript
import { OrderService } from './modules/checkout/services/order.service';

@Injectable()
export class MyService {
  constructor(private orderService: OrderService) {}

  async createOrder(dto: CreateOrderDto) {
    return this.orderService.confirmCheckout(userId, dto);
  }
}
```

## ๐ ุงูุฃุฏุงุก

### ููุงุฑุณ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุญุณูุฉ:
- ููุฑุณ ุฑูู ุงูุทูุจ (ูุฑูุฏ)
- ููุฑุณ ุงููุณุชุฎุฏู ูุงูุญุงูุฉ
- ููุฑุณ ุชุงุฑูุฎ ุงูุฅูุดุงุก
- ููุฑุณ ุฑูู ุงูุชุชุจุน
- ููุฑุณ ุงููุฏููุฉ ูุงูุญุงูุฉ

### ุชุญุณููุงุช ุงูุฃุฏุงุก:
- ุงุณุชุนูุงูุงุช ูุญุณูุฉ
- ุชุฌููุน ุงูุจูุงูุงุช
- ุชุฎุฒูู ูุคูุช ูููุชุงุฆุฌ
- ูุนุงูุฌุฉ ูุชูุงุฒูุฉ

## ๐ ุงูุฃูุงู

### ุญูุงูุฉ ุงูุจูุงูุงุช:
- ุชุดููุฑ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ
- ุงูุชุญูู ูู ุงูุตูุงุญูุงุช
- ุชุณุฌูู ุงูุนูููุงุช
- ุญูุงูุฉ ูู SQL Injection

### ุงูุชุญูู ูู ุงูุชูููุนุงุช:
- HMAC ููู Webhooks
- ุงูุชุญูู ูู ุงููุตุฏุฑ
- ููุน ุงูุชูุงุนุจ

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ:
```bash
npm run test:unit
```

### ุงุฎุชุจุงุฑุงุช ุงูุชูุงูู:
```bash
npm run test:e2e
```

### ุงุฎุชุจุงุฑุงุช ุงูุฃุฏุงุก:
```bash
npm run test:performance
```

## ๐ ุงูุณุฌูุงุช

### ุฃููุงุน ุงูุณุฌูุงุช:
- ุณุฌู ุงูุนูููุงุช
- ุณุฌู ุงูุฃุฎุทุงุก
- ุณุฌู ุงูุฃุฏุงุก
- ุณุฌู ุงูุฃูุงู

### ูุณุชููุงุช ุงูุณุฌูุงุช:
- `ERROR` - ุฃุฎุทุงุก
- `WARN` - ุชุญุฐูุฑุงุช
- `INFO` - ูุนูููุงุช
- `DEBUG` - ุชูุงุตูู

## ๐ ุงูุชุญุฏูุซุงุช

### ุฅุตุฏุงุฑ 2.0.0 (ุงูุญุงูู):
- โ ุชุจุณูุท ุญุงูุงุช ุงูุทูุจุงุช (10 ุญุงูุงุช ุจุฏูุงู ูู 15)
- โ ุชุจุณูุท ุทุฑู ุงูุฏูุน (COD ู BANK_TRANSFER ููุท)
- โ ุชูุญูุฏ OrderStateMachine ูู utils ููุท
- โ ุฅุตูุงุญ ุญุณุงุจ ุงูุฎุตููุงุช (ููุน ุงูุญุณุงุจ ุงููุฒุฏูุฌ)
- โ ุฑุจุท ุงูุณูุฉ ุจุงูุทูุจ (ุชุญุฏูุซ ุชููุงุฆู ุฅูู CONVERTED)
- โ ุฅุตูุงุญ ุชุญููู ุงูุนููุงุช (ุชูุฑูุฑ totalDiscount ุงููุงูู)
- โ ูุตู ูุงุถุญ ุจูู ุญุงูุงุช ุงูุทูุจ ูุญุงูุงุช ุงูุฏูุน

### ุฅุตุฏุงุฑ 1.0.1:
- ุชุญุฏูุซ ุฃุนุฏุงุฏ endpoints ูุชุนูุณ ุงููุงูุน ุงูุตุญูุญ
- 9 customer endpoints ู 12 admin endpoints

### ุฅุตุฏุงุฑ 1.0.0:
- ูุธุงู ููุญุฏ ููุทูุจุงุช
- State Machine ูุชูุฏู
- API ููุญุฏุฉ
- ุชุญูููุงุช ุดุงููุฉ

## ๐ ุงูุฏุนู

ููุญุตูู ุนูู ุงูุฏุนู ุฃู ุงูุฅุจูุงุบ ุนู ูุดุงูู:
- ุฅูุดุงุก Issue ูู GitHub
- ุงูุชูุงุตู ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- ูุฑุงุฌุนุฉ ุงููุซุงุฆู

## ๐ ุงูุชุฑุฎูุต

ูุฐุง ุงููุดุฑูุน ูุฑุฎุต ุชุญุช ุฑุฎุตุฉ MIT.

---

## โ ุญุงูุฉ ุงููุธุงู

**ูุธุงู Checkout ููุชูู ุจุงููุงูู ููุนูู ููุง ูู ููุซู:**
- โ ุฌููุน APIs ูุทุจูุฉ ูุชุนูู
- โ State Machine ูุชูุฏู ูุฏููู
- โ Schema ุดุงูู ูุน ุฌููุน ุงูุญููู ุงููุทููุจุฉ
- โ ูุธุงู ุงูุฃูุงู ูุงูุชุญูู ููุนู
- โ ุชุญูููุงุช ูุฅุญุตุงุฆูุงุช ุดุงููุฉ
- โ Webhooks ูููุนุงูุฌุฉ ุงูุชููุงุฆูุฉ