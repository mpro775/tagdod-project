# Attributes Module

> ๐ท๏ธ **ูุธุงู ุงูุณูุงุช ุงูุนุงูููุฉ (Global Attributes)**

## ูุธุฑุฉ ุนุงูุฉ

Module ูุฅุฏุงุฑุฉ ุงูุณูุงุช ุงูุนุงูููุฉ ุงูููุญุฏุฉ - **ููุชูู ุงูุชูููุฐ 100%**:
- โ ุชูุญูุฏ ูุงูู ููุณูุงุช
- โ ุฃููุงุน ูุชุนุฏุฏุฉ (select, multiselect, text, number, boolean)
- โ ููู ููุญุฏุฉ ูุน ุฏุนู hexCode ูุตูุฑ
- โ ููุชุฑุฉ ูููุฉ ููุชูุฏูุฉ
- โ ุชุชุจุน ุงุณุชุฎุฏุงู ูุน ุฅุญุตุงุฆูุงุช
- โ Soft delete ูุน ุฅููุงููุฉ ุงูุงุณุชุนุงุฏุฉ
- โ๏ธ ุชุฌููุน ุงูุณูุงุช ูู ูุฌููุนุงุช (Schema ููุฌูุฏุ ููู ูุง API ููุฅุฏุงุฑุฉ)

---

## ุงูููููู

```
ุงูุณูุฉ (Attribute):
- ุงูุงุณู: "ุงูููู"
- ุงูุงุณู ุจุงูุฅูุฌููุฒูุฉ: "Color"
- ุงูููุน: select
- ุงูููู: [
    { value: "ุฃุญูุฑ", valueEn: "Red", hexCode: "#FF0000" },
    { value: "ุฃุฒุฑู", valueEn: "Blue", hexCode: "#0000FF" }
  ]

ุงูููุงุฆุฏ:
โ ุชูุญูุฏ - ูู ุงูููุชุฌุงุช ุชุณุชุฎุฏู ููุณ "ุฃุญูุฑ"
โ ููุชุฑุฉ - ุณูู ุฌุฏุงู ูุน ููู ููุญุฏุฉ
โ UI ููุญุฏ - ููุณ ุงูุดูู ููู ุงูููุชุฌุงุช
โ ุฅุญุตุงุฆูุงุช - ุชุชุจุน ุนุฏุฏ ุงูููุชุฌุงุช ุงููุณุชุฎุฏูุฉ
โ ุชูุธูู - ุชุฌููุน ุงูุณูุงุช ูู ูุฌููุนุงุช
```

---

## Schemas

### 1. Attribute - ูุทุจู ูุนููุงู โ

```typescript
{
  name: "ุงูููู",                    // ุงูุงุณู ุจุงูุนุฑุจูุฉ
  nameEn: "Color",                  // ุงูุงุณู ุจุงูุฅูุฌููุฒูุฉ
  slug: "color",                    // ูุนุฑู ูุฑูุฏ
  type: "select",                   // select | multiselect | text | number | boolean
  description: "ููู ุงูููุชุฌ",
  order: 1,                         // ุชุฑุชูุจ ุงูุนุฑุถ
  isActive: true,                   // ูุดุทุฉ ุฃู ูุง
  isFilterable: true,               // ูุงุจูุฉ ููููุชุฑุฉ
  isRequired: false,                // ุฅูุฒุงููุฉ
  showInFilters: true,              // ุนุฑุถ ูู ุงูููุงุชุฑ
  groupId: "group_general",         // ุงููุฌููุนุฉ
  usageCount: 25,                   // ุนุฏุฏ ุงูููุชุฌุงุช ุงููุณุชุฎุฏูุฉ
  deletedAt: null,                  // Soft delete
  deletedBy: null                   // ูู ุญุฐููุง
}
```

### 2. AttributeValue - ูุทุจู ูุนููุงู โ

```typescript
{
  attributeId: "attr_color",
  value: "ุฃุญูุฑ",                    // ุงููููุฉ ุจุงูุนุฑุจูุฉ
  valueEn: "Red",                   // ุงููููุฉ ุจุงูุฅูุฌููุฒูุฉ
  slug: "red",                      // ูุนุฑู ูุฑูุฏ
  hexCode: "#FF0000",               // ููุฏ ุงูููู
  imageUrl: "https://...",          // ุตูุฑุฉ ุงููููุฉ
  imageId: "media_123",             // ูู ูุณุชูุฏุน ุงูุตูุฑ
  description: "ุงูููู ุงูุฃุญูุฑ",
  order: 1,                         // ุชุฑุชูุจ ุงูุนุฑุถ
  isActive: true,                   // ูุดุทุฉ ุฃู ูุง
  usageCount: 12,                   // ุนุฏุฏ ุงูู variants ุงููุณุชุฎุฏูุฉ
  deletedAt: null,                  // Soft delete
  deletedBy: null                   // ูู ุญุฐููุง
}
```

### 3. AttributeGroup - โ๏ธ Schema ููุฌูุฏุ ูุง API

```typescript
{
  name: "ุงูููุงุตูุงุช ุงูุนุงูุฉ",
  nameEn: "General Specifications",
  slug: "general",
  description: "ุงูููุงุตูุงุช ุงูุฃุณุงุณูุฉ ููููุชุฌุงุช",
  order: 1,                         // ุชุฑุชูุจ ุงููุฌููุนุฉ
  isActive: true                    // ูุดุทุฉ ุฃู ูุง
}

// ููุงุญุธุฉ: Schema ููุฌูุฏ ุจุงููุงูู ููู ูุง ููุฌุฏ API ูุฅุฏุงุฑุฉ ุงููุฌููุนุงุช
// ูููู ุงูุฅุดุงุฑุฉ ุฅูู groupId ูู ุงูุณูุงุช ููู ุฅุฏุงุฑุฉ ุงููุฌููุนุงุช ุชุชู ูุจุงุดุฑุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
```

---

## Endpoints - ูุทุจูุฉ ูุนููุงู โ

### Admin Endpoints (ูุญููุฉ - Admin/Super Admin ููุท):
- โ **CRUD ููุณูุงุช**: `POST`, `GET`, `PATCH`, `DELETE` `/admin/attributes`
- โ **CRUD ููููู**: `POST`, `GET`, `PATCH`, `DELETE` `/admin/attributes/{id}/values`
- โ **ุฅุญุตุงุฆูุงุช**: `GET /admin/attributes/stats/summary`
- โ **ุงุณุชุนุงุฏุฉ ูุญุฐูู**: `POST /admin/attributes/{id}/restore`
- โ **ููุชุฑุฉ ูุชูุฏูุฉ**: `?search`, `?isActive`, `?isFilterable`, `?groupId`, `?includeDeleted`
- โ๏ธ **ูุฌููุนุงุช ุงูุณูุงุช**: `groupId` ููุฌูุฏ ูู Schema ููู ูุง ููุฌุฏ API ูุฅุฏุงุฑุฉ ุงููุฌููุนุงุช

### Public Endpoints (ุนุงูุฉ - ูุน Cache):
- โ **ูุงุฆูุฉ ุงูุณูุงุช**: `GET /attributes` (ุงููุดุทุฉ ููุท)
- โ **ุงูุณูุงุช ุงููุงุจูุฉ ููููุชุฑุฉ**: `GET /attributes/filterable` (ูุน ููููุง)
- โ **ุณูุฉ ูุงุญุฏุฉ**: `GET /attributes/{id}` (ูุน ููููุง)
- โ **Cache**: 30 ุฏูููุฉ ูุฌููุน ุงูู public endpoints

---

## ุฃูุซูุฉ ุงูุงุณุชุฎุฏุงู - ูุทุจูุฉ ูุนููุงู โ

### ุฅูุดุงุก ุณูุฉ ุฌุฏูุฏุฉ:
```http
POST /admin/attributes
Authorization: Bearer {admin_token}

{
  "name": "ุงูููู",
  "nameEn": "Color",
  "type": "select",
  "description": "ููู ุงูููุชุฌ",
  "order": 1,
  "isFilterable": true,
  "isRequired": false,
  "showInFilters": true,
  "groupId": "group_general"
}

Response:
{
  "data": {
    "_id": "attr_123",
    "name": "ุงูููู",
    "nameEn": "Color",
    "slug": "color",
    "type": "select",
    "isFilterable": true,
    "usageCount": 0,
    "createdAt": "2024-01-15T10:30:00Z"
  }
}
```

### ุฅุถุงูุฉ ููู ููุณูุฉ:
```http
POST /admin/attributes/attr_123/values
Authorization: Bearer {admin_token}

{
  "value": "ุฃุญูุฑ",
  "valueEn": "Red",
  "hexCode": "#FF0000",
  "description": "ุงูููู ุงูุฃุญูุฑ",
  "order": 1
}

Response:
{
  "data": {
    "_id": "value_456",
    "attributeId": "attr_123",
    "value": "ุฃุญูุฑ",
    "valueEn": "Red",
    "slug": "red",
    "hexCode": "#FF0000",
    "usageCount": 0
  }
}
```

### ุฌูุจ ุงูุณูุงุช ุงููุงุจูุฉ ููููุชุฑุฉ (ูููุงุฌูุฉ ุงูุนุงูุฉ):
```http
GET /attributes/filterable

Response:
{
  "data": [
    {
      "_id": "attr_123",
      "name": "ุงูููู",
      "nameEn": "Color",
      "type": "select",
      "isFilterable": true,
      "values": [
        {
          "_id": "value_456",
          "value": "ุฃุญูุฑ",
          "valueEn": "Red",
          "hexCode": "#FF0000"
        }
      ]
    }
  ]
}
```

---

## ุงููููุฒุงุช ุงููุชูุฏูุฉ ุงููุทุจูุฉ โ

### 1. ุฃููุงุน ุงูุณูุงุช ุงููุชุนุฏุฏุฉ:
- โ **select**: ุงุฎุชูุงุฑ ูุงุญุฏ (ูุซู: ุงูููู)
- โ **multiselect**: ุงุฎุชูุงุฑ ูุชุนุฏุฏ (ูุซู: ุงููููุฒุงุช)
- โ **text**: ูุต ุญุฑ (ูุซู: ุงููุงุฏุฉ)
- โ **number**: ุฑูู (ูุซู: ุงููุฒู)
- โ **boolean**: ูุนู/ูุง (ูุซู: ูุงุจู ููุบุณู)

### 2. ุชุชุจุน ุงูุงุณุชุฎุฏุงู:
- โ **usageCount** ููุณูุงุช: ุนุฏุฏ ุงูููุชุฌุงุช ุงููุณุชุฎุฏูุฉ
- โ **usageCount** ููููู: ุนุฏุฏ ุงูู variants ุงููุณุชุฎุฏูุฉ
- โ **incrementUsage()**: ุฒูุงุฏุฉ ุนูุฏ ุงูุงุณุชุฎุฏุงู
- โ **decrementUsage()**: ููุตุงู ุนูุฏ ุงูุญุฐู

### 3. Soft Delete:
- โ **deletedAt**: ุชุงุฑูุฎ ุงูุญุฐู
- โ **deletedBy**: ูู ุญุฐู ุงูุณูุฉ/ุงููููุฉ
- โ **restoreAttribute()**: ุงุณุชุนุงุฏุฉ ุงูุณูุฉ ุงููุญุฐููุฉ
- โ ููุน ุญุฐู ุงูุณูุงุช/ุงูููู ุงููุณุชุฎุฏูุฉ

### 4. ุงูููุชุฑุฉ ูุงูุจุญุซ:
- โ **search**: ุจุญุซ ูู ุงูุงุณู ุงูุนุฑุจู ูุงูุฅูุฌููุฒู
- โ **isActive**: ุงูุณูุงุช ุงููุดุทุฉ ููุท
- โ **isFilterable**: ุงูุณูุงุช ุงููุงุจูุฉ ููููุชุฑุฉ
- โ **groupId**: ููุชุฑุฉ ุญุณุจ ุงููุฌููุนุฉ
- โ **includeDeleted**: ุนุฑุถ ุงููุญุฐููุฉ

### 5. ุงูุฃุฏุงุก ูุงูุชุญุณูู:
- โ **Indexes ูุญุณููุฉ**: ููุจุญุซ ุงูุณุฑูุน
- โ **Cache**: 30 ุฏูููุฉ ููู public endpoints
- โ **Population**: ุฌูุจ ุงููุฌููุนุงุช ูุงูููู
- โ **Lean queries**: ุงุณุชุนูุงูุงุช ูุญุณููุฉ

### 6. ุงูุฃูุงู ูุงูุตูุงุญูุงุช:
- โ **JWT Auth**: ูุตุงุฏูุฉ ูุทููุจุฉ ููู admin
- โ **Roles Guard**: Admin/Super Admin ููุท
- โ **Validation**: ุชุญูู ุดุงูู ูู ุงูุจูุงูุงุช
- โ **Error Handling**: ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ

### 7. ูุฌููุนุงุช ุงูุณูุงุช:
- โ๏ธ **Schema ููุฌูุฏ**: `AttributeGroup` schema ูุทุจู ุจุงููุงูู
- โ๏ธ **Reference ูุชุงุญ**: `groupId` ูู `Attribute` schema
- โ **ูุง API ููุฅุฏุงุฑุฉ**: ูุง ูููู ุฅูุดุงุก/ุชุญุฏูุซ/ุญุฐู ุงููุฌููุนุงุช ุนุจุฑ API
- ๐ก **ุทุฑููุฉ ุงูุนูู**: ุงููุฌููุนุงุช ุชูุฏุงุฑ ูุจุงุดุฑุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

---

## ุงูุฅุญุตุงุฆูุงุช ุงููุชุงุญุฉ โ

```http
GET /admin/attributes/stats/summary

Response:
{
  "data": {
    "total": 25,           // ุฅุฌูุงูู ุงูุณูุงุช
    "active": 20,          // ุงูุณูุงุช ุงููุดุทุฉ
    "filterable": 15,      // ุงููุงุจูุฉ ููููุชุฑุฉ
    "byType": {            // ุญุณุจ ุงูููุน
      "select": 12,
      "text": 5,
      "number": 3,
      "boolean": 2,
      "multiselect": 3
    }
  }
}
```

---

**Status:** โ Complete - ููุชูู ุงูุชูููุฐ 100% (ูุน ุงุณุชุซูุงุก ุฅุฏุงุฑุฉ ุงููุฌููุนุงุช)
**Version:** 1.0.0
**Last Updated:** 2024-01-15

**ููุงุญุธุฉ ูููุฉ:** ูุธุงู ุงูุณูุงุช ููุชูู ุจุงููุงูู ุจุงุณุชุซูุงุก ุฅุฏุงุฑุฉ ูุฌููุนุงุช ุงูุณูุงุช ุนุจุฑ API. ุงููุฌููุนุงุช ููุฌูุฏุฉ ูู Schema ููููู ุงูุฅุดุงุฑุฉ ุฅูููุงุ ููู ุฅุฏุงุฑุชูุง ุชุชู ูุจุงุดุฑุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.


