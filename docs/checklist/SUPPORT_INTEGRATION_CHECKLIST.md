# ✅ Support Module Integration Checklist

> قائمة تحقق عملية لتأكيد تكامل وحدة الدعم الفني مع واجهات المستخدمين النهائيين والفرق الهندسية والتجارية، مع استبعاد جميع العمليات الإدارية.

## كيفية الاستخدام
- نفّذ العناصر الواردة أثناء تشغيل الاختبارات في بيئة تمكّن من استقبال التذاكر والرسائل والإشعارات الحقيقية أو المُمكنة.
- استخدم حسابات اختبار تمثل جميع الأدوار المتأثرة (مستخدم، مهندس/تاجر إذا كانوا يفتحون تذاكر).
- دوّن الملاحظات أو الأعطال أسفل كل قسم لتسهيل المتابعة والتوثيق.

---

## 1. التحضير العام
- [ ] تفعيل `SupportModule` في البيئة المستهدفة مع اعتمادياته (`NotificationsModule`, `UsersModule`, إلخ).
- [ ] تجهيز حسابات اختبار (مستخدمين عاديين، مهندسين، تجار) لتجربة تدفق التذاكر.
- [ ] التحقق من إعداد القنوات المستخدمة للإشعارات (Email/SMS/Push) إذا كانت جزءاً من تجربة الدعم.
- [ ] ضبط بيانات اختبار للتذاكر (أصناف مختلفة: `technical`, `billing`, `services`, `account`, `other`).
- [ ] تفعيل مراقبة السجلات (Logs/APM) لرصد إنشاء التذاكر وتتبع SLA والرسائل.

ملاحظات:

---

## 2. نظرة عامة على المسارات (غير الإدارية)

| المسار | الوصف | يتطلب JWT | ملاحظات |
|--------|-------|------------|---------|
| `POST /support/tickets` | إنشاء تذكرة دعم جديدة | نعم | يتطلب عنوان ووصف وفئة وأولوية |
| `GET /support/tickets/my` | جلب تذاكر المستخدم | نعم | يدعم التصفية بالحالة والأولوية |
| `GET /support/tickets/:id` | تفاصيل تذكرة محددة | نعم | يعرض الحالة، السجل، SLA |
| `POST /support/tickets/:id/messages` | إضافة رسالة إلى التذكرة | نعم | يُستخدم للمحادثة |
| `GET /support/tickets/:id/messages` | جلب رسائل التذكرة | نعم | يعيد الرسائل مرتبة زمنياً |
| `POST /support/tickets/:id/rate` | تقييم التذكرة بعد الحل | نعم | 1-5 نجوم مع feedback |
| `PUT /support/tickets/:id/archive` | أرشفة التذكرة | نعم | يغيّر حالة العرض في الواجهة |

> كل المسارات أعلاه مخصصة لتجارب المستخدمين/العملاء، ولا تشمل أي Endpoint إداري.

---

## 3. التحقق المشترك (جميع الأدوار)
- [ ] التأكد من أن جميع المسارات تتطلب JWT صالح؛ وإرجاع 401 عند غيابه.
- [ ] تجربة إنشاء تذكرة لكل فئة (`technical`, `billing`, `products`, `services`, `account`, `other`) والتأكد من حفظ البيانات.
- [ ] التحقق من أن الأولوية (`priority`: urgent/high/medium/low) تؤثر على SLA (مثلاً `urgent` خلال ساعة).
- [ ] مراقبة أن حالة التذكرة تنتقل بين `open → in_progress → waiting_for_user → resolved/closed`.
- [ ] التأكد من أن التذكرة لا تُقَيَّم إلا بعد الوصول إلى حالة `resolved` أو `closed`، وأن النظام يمنع التقييم المكرر.
- [ ] التحقق من أن الأرشفة (`archive`) تؤثر على ظهور التذكرة في القوائم العامة (مثلاً الانتقال إلى قسم "المؤرشفة").

ملاحظات:

---

## 4. المستخدمون النهائيون (Customers)
- [ ] فتح تذكرة جديدة عبر الواجهة الأمامية والتأكد من ظهورها فوراً في `GET /support/tickets/my`.
- [ ] إرسال رسالة متابعة (`POST /support/tickets/:id/messages`) والتأكد من ظهورها في قائمة الرسائل مع الطابع الزمني الصحيح.
- [ ] استلام رد من الفريق (عبر واجهة الإدارة أو سكربت) والتأكد من ظهوره للمستخدم في `GET /support/tickets/:id/messages`.
- [ ] اختبار إغلاق التذكرة من جهة الإدارة، ثم تقييمها من حساب المستخدم والتأكد من حفظ التقييم.
- [ ] تجربة أرشفة التذكرة (`PUT /support/tickets/:id/archive`) ومراقبة اختفائها من قائمة "التذاكر الجارية" وظهورها في قسم مخصص.

ملاحظات:

---

## 5. المهندسون / التجار (إن كانوا يستخدمون الدعم)
- [ ] تأكيد إمكانية المهندس أو التاجر إنشاء تذكرة بصفته مستخدم دعم، والتأكد من أن الفئات المتاحة مناسبة لدوره.
- [ ] مراقبة إدراج المعلومات المتعلقة بـ `services` أو `orders` داخل التذكرة (إن كان التكامل يوفرها).
- [ ] تجربة الرد على التذكرة من الواجهة الأمامية الخاصة بالدور والتأكد من تسجيل الرسائل بالشكل الصحيح.
- [ ] مراقبة أوضاع SLA والتقييمات حين تكون التذاكر المرتبطة بدورهم مغلقة.

ملاحظات:

---

## 6. التكامل مع الوحدات الأخرى
- [ ] التأكد من أن `NotificationsModule` يرسل إشعاراً عند إنشاء تذكرة جديدة أو الرد عليها (Email/SMS/Push).
- [ ] التحقق من ارتباط التذاكر بوحدات أخرى (مثل الطلبات أو الخدمات) وعرض المراجع في تفاصيل التذكرة عند الحاجة.
- [ ] اختبار التكامل مع `Analytics` أو `Reporting` للتأكد من تسجيل التذكرة ووقاتها ضمن الإحصائيات.
- [ ] التأكد من أن استخدام الردود الجاهزة (Canned Responses) يظهر في رسائل التذكرة لدى المستخدم (حتى لو كان الاستدعاء يتم من جهة الإدارة).

ملاحظات:

---

## 7. SLA و الوقت
- [ ] مراقبة الزمن بين فتح التذكرة والرد الأول للتأكد من مطابقته لـ SLA (خاصة للأولويات العليا).
- [ ] اختبار سيناريو تجاوز SLA والتأكد من تسجيله في الحقول الخاصة بالتذكرة (حتى لو كان المنطق الإداري غير متاح للمستخدم).
- [ ] التحقق من أن `GET /support/tickets/:id` يعرض الوقت المتبقي أو حالة SLA للمستخدم (إن كانت واجهة المستخدم تعرض ذلك).

ملاحظات:

---

## 8. الاستقرار والمراقبة
- [ ] مراجعة السجلات للتأكد من تسجيل جميع الأحداث (إنشاء تذكرة، إضافة رسالة، إغلاق، تقييم).
- [ ] مراقبة أداء الاستعلامات عند وجود عدد كبير من الرسائل في تذكرة واحدة.
- [ ] اختبار تحميل خفيف عبر إنشاء عدة تذاكر متزامنة للتأكد من عدم وجود عنق زجاجة في الخدمة.
- [ ] التأكد من آلية الأرشفة وأنها لا تؤدي إلى حذف البيانات أو فقدان الرسائل.

ملاحظات:

---

## 9. متطلبات ما بعد التشغيل
- [ ] تحديث دليل فرق الدعم حول كيفية تفسير التقييمات والتعامل مع التذاكر المؤرشفة.
- [ ] مشاركة نتائج الاختبار مع فريق الجودة للتأكد من تغطية سيناريوهات SLA والتقييم.
- [ ] جدولة مراجعة دورية (شهرية/ربع سنوية) لقياس جودة الدعم من خلال التقييمات والأوقات الفعلية.
- [ ] توثيق أي حالات استثنائية أو مشكلات تم اكتشافها أثناء الاختبارات للمتابعة المستقبلية.

ملاحظات:

---

**عند اكتمال جميع العناصر أعلاه يمكن اعتماد تكامل وحدة الدعم الفني بثقة لجميع الأدوار غير الإدارية.**

