%% Users Overview Flow
%% View at https://mermaid.live
flowchart TD
  A[نظام المستخدمين] --> B[أدوار متعددة]

  B --> C[USER - مستخدم عادي]
  B --> D[ENGINEER - مهندس]
  B --> E[MERCHANT - تاجر]
  B --> F[ADMIN - مدير]
  B --> G[SUPER_ADMIN - مدير عام]

  C --> C1[Capabilities: customer_capable = true]
  C1 --> C2[Status: ACTIVE - موثق مباشرة]
  
  D --> D1[Capabilities: engineer_capable = true]
  D1 --> D2[Status: UNVERIFIED - يحتاج تحقق]
  D2 --> D3[رفع CV → PENDING]
  
  E --> E1[Capabilities: wholesale_capable = true]
  E1 --> E2[Status: UNVERIFIED - يحتاج تحقق]
  E2 --> E3[رفع صورة المحل + اسم المحل → PENDING]

  C1 --> H[نظام الصلاحيات]
  D1 --> H
  E1 --> H
  F1 --> H

  H --> H1[Roles: أدوار أساسية]
  H --> H2[Permissions: صلاحيات مخصصة]
  H --> H3[Capabilities: قدرات محددة]

  H3 --> I[Capabilities Status]
  I --> I1[NONE - غير محدد]
  I --> I2[UNVERIFIED - غير موثق]
  I --> I3[PENDING - قيد المراجعة]
  I --> I4[APPROVED - مقبول]
  I --> I5[REJECTED - مرفوض]

  I5 --> V[نظام التحقق]
  V --> V1[رفع الوثائق]
  V1 --> V2[مراجعة الأدمن]
  V2 --> V3[الموافقة/الرفض]
  
  V3 --> J[إدارة الحسابات]
  J --> J1[Status: active/suspended/pending/deleted]
  J --> J2[Soft Delete: deletedAt, deletedBy, deletionReason]
  J --> J3[Suspension: suspendedReason, suspendedBy, suspendedAt]

  J3 --> K[تحليلات المستخدمين]
  K --> K1[User Analytics: إحصائيات شاملة]
  K --> K2[User Scoring: نظام النقاط]
  K --> K3[User Rankings: ترتيب المستخدمين]

  K3 --> L[تكامل مع الأنظمة]
  L --> L1[Orders: ربط مع الطلبات]
  L --> L2[Services: ربط مع الخدمات]
  L --> L3[Support: ربط مع الدعم]
  L --> L4[Analytics: تحليلات شاملة]
  L --> L5[Verification: نظام التحقق]

  %% End points
  L4 --> M[نهاية - نظام متكامل]
  L5 --> M
