%% Inventory Validation & Tracking Flow
%% View at https://mermaid.live
flowchart TD
  A[فحص المخزون] --> B{نوع الفحص?}
  B -->|فحص التوفر| C[فحص توفر المخزون]
  B -->|عرض الحالة| D[عرض حالة المخزون]

  %% Availability Check
  C --> C1[استلام معرف المتغير والكمية المطلوبة]
  C1 --> C2[قراءة قيمة stock من Variant]
  C2 --> C3{trackInventory مفعل?}
  C3 -->|نعم| C4{stock >= المطلوب?}
  C3 -->|لا| C5[المخزون متاح دائماً]
  C4 -->|نعم| C6[المخزون متاح]
  C4 -->|لا| C7{allowBackorder مفعل?}
  C7 -->|نعم| C8[السماح بالطلب على أي حال]
  C7 -->|لا| C9[المخزون غير متاح]
  C5 --> C6
  C6 --> C10[إرجاع متاح]
  C8 --> C10
  C9 --> C11[إرجاع غير متاح]

  %% Display Status
  D --> D1[قراءة معلومات المخزون من Variant]
  D1 --> D2[إرجاع stock و minStock و trackInventory]
