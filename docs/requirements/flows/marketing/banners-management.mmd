%% Banners Management Flow
%% View at https://mermaid.live
flowchart TD
  A[إدارة البانرات] --> B{نوع العملية?}
  B -->|إنشاء بانر| C[إنشاء بانر]
  B -->|تحديث بانر| D[تحديث بانر]
  B -->|حذف بانر| E[حذف بانر]
  B -->|عرض البانرات| F[عرض البانرات]
  B -->|تتبع المشاهدات| G[تتبع المشاهدات]

  %% Create Banner
  C --> C1[استلام بيانات البانر]
  C1 --> C2[التحقق من صحة البيانات]
  C2 --> C3[إنشاء كائن البانر]
  C3 --> C4[حفظ في قاعدة البيانات]
  C4 --> C5[إرجاع البانر المنشأ]

  %% Update Banner
  D --> D1[استلام معرف البانر وبيانات التحديث]
  D1 --> D2[البحث عن البانر]
  D2 --> D3{البانر موجود?}
  D3 -->|لا| D4[إرجاع خطأ]
  D3 -->|نعم| D5[تحديث البيانات]
  D5 --> D6[حفظ التغييرات]
  D6 --> D7[إرجاع البانر المحدث]
  D4 --> D8[نهاية - غير موجود]

  %% Delete Banner
  E --> E1[استلام معرف البانر]
  E1 --> E2[البحث عن البانر]
  E2 --> E3{البانر موجود?}
  E3 -->|لا| E4[إرجاع خطأ]
  E3 -->|نعم| E5[Soft Delete للبانر]
  E5 --> E6[إرجاع نجاح الحذف]
  E4 --> E7[نهاية - غير موجود]

  %% List Banners
  F --> F1[استلام معايير البحث والموقع]
  F1 --> F2[البحث في قاعدة البيانات]
  F2 --> F3[فلترة حسب الموقع والنشاط]
  F3 --> F4[ترتيب حسب sortOrder]
  F4 --> F5[إرجاع قائمة البانرات]

  %% Track Views
  G --> G1[استلام معرف البانر ونوع الحدث]
  G1 --> G2[البحث عن البانر]
  G2 --> G3{البانر موجود?}
  G3 -->|لا| G4[إرجاع خطأ]
  G3 -->|نعم| G5{نوع الحدث?}
  G5 -->|مشاهدة| G6[زيادة viewCount]
  G5 -->|نقر| G7[زيادة clickCount]
  G5 -->|تحويل| G8[زيادة conversionCount]
  G6 --> G9[حفظ التغييرات]
  G7 --> G9
  G8 --> G9
  G9 --> G10[إرجاع نجاح التتبع]
  G4 --> G11[نهاية - غير موجود]
