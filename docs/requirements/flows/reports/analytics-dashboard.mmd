%% Analytics Dashboard Flow
%% View at https://mermaid.live
flowchart TD
  A[طلب بيانات لوحة التحكم] --> B[استلام معايير الاستعلام]
  B --> B1[period: الفترة الزمنية]
  B1 --> B2[startDate, endDate: تواريخ محددة]
  B2 --> B3[compareWithPrevious: المقارنة]

  B3 --> C[استخراج البيانات المتعددة]
  C --> C1[calculateUserAnalytics]
  C1 --> C2[calculateProductAnalytics]
  C2 --> C3[calculateOrderAnalytics]
  C3 --> C4[calculateServiceAnalytics]
  C4 --> C5[calculateSupportAnalytics]
  C5 --> C6[calculateRevenueAnalytics]
  C6 --> C7[calculateGeographyAnalytics]
  C7 --> C8[calculateFileAnalytics]

  C8 --> D[حساب مقاييس الأداء]
  D --> D1[calculatePerformanceMetrics]
  D1 --> D2[responseTime, memoryUsage, etc.]

  D2 --> E[تنظيم البيانات للعرض]
  E --> E1[users: إحصائيات المستخدمين]
  E1 --> E2[products: إحصائيات المنتجات]
  E2 --> E3[orders: إحصائيات الطلبات]
  E3 --> E4[services: إحصائيات الخدمات]
  E3 --> E5[support: إحصائيات الدعم]
  E5 --> E6[revenue: إحصائيات الإيرادات]
  E6 --> E7[geography: التوزيع الجغرافي]
  E7 --> E8[files: إحصائيات الملفات]
  E8 --> E9[performance: مقاييس الأداء]

  E9 --> F[التحقق من التخزين المؤقت]
  F --> F1{البيانات موجودة في Cache?}
  F1 -->|نعم| F2[إرجاع البيانات المخزنة]
  F1 -->|لا| F3[حفظ في Cache للاستخدام المستقبلي]

  F3 --> G[إرجاع الاستجابة]
  F2 --> G

  %% User Analytics
  H[تحليلات المستخدمين] --> H1[إجمالي المستخدمين]
  H1 --> H2[المستخدمون النشطون]
  H2 --> H3[المستخدمون الجدد]
  H3 --> H4[توزيع حسب الأدوار]

  %% Product Analytics
  I[تحليلات المنتجات] --> I1[إجمالي المنتجات]
  I1 --> I2[المنتجات الأكثر مبيعاً]
  I2 --> I3[متوسط التقييمات]
  I3 --> I4[إحصائيات المخزون]

  %% Order Analytics
  J[تحليلات الطلبات] --> J1[إجمالي الإيرادات]
  J1 --> J2[عدد الطلبات]
  J2 --> J3[متوسط قيمة الطلب]
  J3 --> J4[نمو المبيعات]

  %% Service Analytics
  K[تحليلات الخدمات] --> K1[إجمالي طلبات الخدمة]
  K1 --> K2[طلبات مكتملة]
  K2 --> K3[طلبات معلقة]
  K3 --> K4[توزيع حسب الحالة]

  %% End point
  G --> L[نهاية - بيانات لوحة التحكم]
