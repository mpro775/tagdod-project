%% KPI Tracking Flow
%% View at https://mermaid.live
flowchart TD
  A[تتبع مؤشرات الأداء] --> B{نوع المؤشر?}
  B -->|مبيعات| C[KPI المبيعات]
  B -->|عملاء| D[KPI العملاء]
  B -->|منتجات| E[KPI المنتجات]
  B -->|خدمات| F[KPI الخدمات]
  B -->|دعم| G[KPI الدعم]

  %% Sales KPIs
  C --> C1[إجمالي الإيرادات]
  C1 --> C2[عدد الطلبات]
  C2 --> C3[متوسط قيمة الطلب]
  C3 --> C4[نمو المبيعات]

  %% Customer KPIs
  D --> D1[إجمالي المستخدمين]
  D1 --> D2[المستخدمون النشطون]
  D2 --> D3[المستخدمون الجدد]
  D3 --> D4[توزيع حسب الأدوار]

  %% Product KPIs
  E --> E1[إجمالي المنتجات]
  E1 --> E2[المنتجات الأكثر مبيعاً]
  E2 --> E3[متوسط التقييمات]
  E3 --> E4[إحصائيات المخزون]

  %% Service KPIs
  F --> F1[إجمالي طلبات الخدمة]
  F1 --> F2[طلبات مكتملة]
  F2 --> F3[طلبات معلقة]
  F3 --> F4[توزيع حسب الحالة]

  %% Support KPIs
  G --> G1[إجمالي التذاكر]
  G1 --> G2[تذاكر مفتوحة]
  G2 --> G3[متوسط وقت الاستجابة]
  G3 --> G4[رضا العملاء]

  %% Data Collection
  H[جمع البيانات] --> H1[استعلام قاعدة البيانات]
  H1 --> H2[فلترة حسب الفترة الزمنية]
  H2 --> H3[حساب المجاميع والمتوسطات]
  H3 --> H4[مقارنة مع الفترة السابقة]

  %% Calculation Methods
  I[طرق الحساب] --> I1[Aggregation Queries]
  I1 --> I2[MongoDB Pipeline]
  I2 --> I3[Date Range Filtering]
  I3 --> I4[Percentage Calculations]

  %% Trending Analysis
  J[تحليل الاتجاهات] --> J1[مقارنة مع الفترة السابقة]
  J1 --> J2[حساب نسبة النمو]
  J2 --> J3[تحديد الاتجاهات الصاعدة والهابطة]
  J3 --> J4[إنشاء تنبيهات للتغييرات المهمة]

  %% Visualization
  K[العرض المرئي] --> K1[Charts and Graphs]
  K1 --> K2[KPIs Cards]
  K2 --> K3[Trend Lines]
  K3 --> K4[Comparison Bars]

  %% Real-time Updates
  L[التحديثات في الوقت الفعلي] --> L1[WebSocket Connections]
  L1 --> L2[Live Data Updates]
  L2 --> L3[Dashboard Refresh]
  L3 --> L4[Push Notifications]

  %% End points
  C4 --> M[نهاية - مؤشرات المبيعات]
  D4 --> M
  E4 --> M
  F4 --> M
  G4 --> M
