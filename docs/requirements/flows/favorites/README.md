# تدفقات المفضلات (Favorites Flows)

## الملفات المتاحة
- `favorites-sync.mmd` - مخطط إدارة المفضلات ومزامنتها

## شرح التدفقات

### 1. إضافة للمفضلات
- **المستخدمون المسجلون:** حفظ في قاعدة البيانات
- **الزوار:** حفظ في localStorage/deviceId
- **التحديث:** تحديث عداد المفضلات للمنتج
- **الإشعارات:** إشعار المستخدم بنجاح الإضافة

### 2. إزالة من المفضلات
- **البحث:** العثور على المفضلة في القائمة
- **الحذف:** إزالة من قاعدة البيانات أو localStorage
- **التحديث:** تحديث العداد
- **الإشعارات:** تأكيد الإزالة

### 3. مزامنة المفضلات
- **المشكلة:** فقدان المفضلات عند التسجيل
- **الحل:** دمج مفضلات الزائر مع مفضلات المستخدم
- **الخطوات:**
  1. البحث عن مفضلات الزائر
  2. البحث عن مفضلات المستخدم
  3. دمج القائمتين
  4. إزالة التكرارات
  5. تعيين علامة المزامنة

### 4. إدارة المفضلات
- **التنظيم:** إمكانية تنظيم بالوسوم
- **البحث:** البحث في المفضلات
- **المشاركة:** إمكانية مشاركة المفضلات
- **الإحصائيات:** تتبع المشاهدات والاستخدام

## نقاط مهمة
- دعم الزوار والمستخدمين المسجلين
- مزامنة تلقائية عند التسجيل
- منع التكرار في المفضلات
- تتبع إحصائيات المشاهدات
- دعم الوسوم والتنظيم
