# ๐ C4 Model - Level 2: Container Diagram

## ูุธุฑุฉ ุนุงูุฉ
ูุฐุง ุงููุณุชูู ููุถุญ **ุงูุญุงููุงุช ุงูุฑุฆูุณูุฉ** (Containers) ูู ูุธุงู ุชุงุฌุง ุฏูุฏู ูููู ุชุชูุงุนู ูุน ุจุนุถูุง.

**ููุงุญุธุฉ**: Container ููุง ูุง ูุนูู Docker Containerุ ุจู ูุนูู ูุญุฏุฉ ูุงุจูุฉ ูููุดุฑ (Deployable Unit) ูุซู Web App, Mobile App, Database, ุฅูุฎ.

---

## ๐ฏ ูุฎุทุท ุงูุญุงููุงุช (Mermaid)

```mermaid
graph TB
    subgraph Users["๐ฅ ุงููุณุชุฎุฏููู"]
        Customer["๐ ุงูุนููู"]
        Admin["๐จโ๐ผ ุงููุฏูุฑ"]
        Engineer["๐ง ุงููููุฏุณ"]
        Support["๐ฌ ุงูุฏุนู"]
    end

    subgraph Application["๐ข ุชุทุจููุงุช ุชุงุฌุง ุฏูุฏู"]
        
        subgraph WebLayer["ุทุจูุฉ ุงูููุจ"]
            AdminPanel["๐ป Admin Panel<br/>React + TypeScript<br/>Material-UI<br/><br/>โข ููุญุฉ ุชุญูู ูุงููุฉ โ<br/>โข ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช โ<br/>โข ุงูุชุญูููุงุช ุงููุชูุฏูุฉ โ<br/>โข ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู โ<br/>โข ุฅุฏุงุฑุฉ ุงูุทูุจุงุช โ<br/>โข ุฅุฏุงุฑุฉ ุงูุฎุฏูุงุช โ<br/>โข ุงูุฏุนู ุงูููู โ<br/>โข RTL Support โ<br/>โข Analytics Dashboard โ"]
            
            CustomerWeb["๐ ูููุน ุงูุนููุงุก<br/>React + TypeScript<br/>(ูุฎุทุท ูููุณุชูุจู)<br/><br/>โข ูุงุฌูุฉ ููุนููุงุก<br/>โข ุชุตูุญ ูุดุฑุงุก<br/>โข PWA"]
        end
        
        subgraph MobileLayer["ุทุจูุฉ ุงููุงุชู"]
            CustomerApp["๐ฑ ุชุทุจูู ุงูุนููุงุก<br/>React Native/Flutter<br/>(ูุฎุทุท)<br/><br/>โข iOS + Android<br/>โข Offline Support<br/>โข Push Notifications"]
            
            EngineerApp["๐ง ุชุทุจูู ุงููููุฏุณูู<br/>React Native<br/>(ูุณุชูุจูุงู)<br/><br/>โข ุฅุฏุงุฑุฉ ุงูููุงุนูุฏ<br/>โข ุชุญุฏูุซ ุญุงูุฉ ุงูุฎุฏูุฉ"]
        end
        
        subgraph BackendLayer["ุทุจูุฉ ุงูุฎูููุฉ"]
            API["โ๏ธ Backend API<br/>NestJS + TypeScript<br/>Node.js 20+<br/><br/>โข REST API<br/>โข JWT Auth<br/>โข Swagger Docs<br/>โข Rate Limiting<br/>โข Caching<br/>โข Multi-language"]
        end
    end

    subgraph Data["๐๏ธ ุทุจูุฉ ุงูุจูุงูุงุช"]
        MongoDB["๐ MongoDB<br/>Database<br/><br/>โข ุงูุจูุงูุงุช ุงูุฑุฆูุณูุฉ<br/>โข ุงูููุชุฌุงุช<br/>โข ุงูุทูุจุงุช<br/>โข ุงููุณุชุฎุฏููู"]
        
        Redis["๐ด Redis<br/>Cache & Sessions<br/><br/>โข ุงูุฌูุณุงุช<br/>โข ุงูุชุฎุฒูู ุงููุคูุช<br/>โข Rate Limiting<br/>โข Queue"]
    end

    subgraph External["๐ ุฎุฏูุงุช ุฎุงุฑุฌูุฉ"]
        Storage["๐๏ธ S3/Cloudinary<br/>ุชุฎุฒูู ุงููููุงุช"]
        Payment["๐ณ Payment Gateway<br/>ูุนุงูุฌุฉ ุงูุฏูุน"]
        SMS["๐ฑ SMS Service<br/>ุฑุณุงุฆู ูุตูุฉ"]
        Email["๐ง Email Service<br/>ุจุฑูุฏ ุฅููุชุฑููู"]
        Maps["๐บ๏ธ Google Maps<br/>ุฎุฑุงุฆุท"]
        Firebase["๐ Firebase<br/>Push Notifications"]
    end

    %% ุงูุนูุงูุงุช - ุงููุณุชุฎุฏููู ุฅูู ุงูุชุทุจููุงุช
    Admin -->|"HTTPS"| AdminPanel
    Customer -->|"HTTPS"| CustomerWeb
    Customer -->|"Mobile"| CustomerApp
    Engineer -->|"Mobile"| EngineerApp
    Support -->|"HTTPS"| AdminPanel

    %% ุงูุนูุงูุงุช - ุงูุชุทุจููุงุช ุฅูู API
    AdminPanel -->|"REST API<br/>HTTPS<br/>JSON<br/>JWT Token"| API
    CustomerWeb -->|"REST API<br/>HTTPS"| API
    CustomerApp -->|"REST API<br/>HTTPS"| API
    EngineerApp -->|"REST API<br/>HTTPS"| API

    %% ุงูุนูุงูุงุช - API ุฅูู ุงูุจูุงูุงุช
    API -->|"Mongoose<br/>TCP/IP"| MongoDB
    API -->|"ioredis<br/>TCP/IP"| Redis

    %% ุงูุนูุงูุงุช - API ุฅูู ุงูุฎุฏูุงุช ุงูุฎุงุฑุฌูุฉ
    API -->|"REST API<br/>HTTPS"| Storage
    API -->|"REST API<br/>Webhook"| Payment
    API -->|"REST API"| SMS
    API -->|"SMTP/API"| Email
    API -->|"REST API"| Maps
    API -->|"SDK"| Firebase

    %% ุนูุณ ุงูุนูุงูุงุช
    Payment -.->|"Webhook<br/>Callback"| API
    SMS -.->|"Callback"| API

    %% ุงูุฃููุงุท
    classDef webApp fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef mobileApp fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef backend fill:#fff3e0,stroke:#f57c00,stroke-width:3px
    classDef database fill:#e8f5e9,stroke:#388e3c,stroke-width:2px
    classDef external fill:#fce4ec,stroke:#c2185b,stroke-width:2px

    class AdminPanel,CustomerWeb webApp
    class CustomerApp,EngineerApp mobileApp
    class API backend
    class MongoDB,Redis database
    class Storage,Payment,SMS,Email,Maps,Firebase external
```

---

## ๐ฏ ูุฎุทุท ุงูุญุงููุงุช (PlantUML)

```plantuml
@startuml Container Diagram
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

LAYOUT_WITH_LEGEND()

title Container Diagram - ุญุงููุงุช ูุธุงู ุชุงุฌุง ุฏูุฏู

Person(customer, "ุงูุนููู", "ุงููุณุชุฎุฏู ุงูููุงุฆู")
Person(admin, "ุงููุฏูุฑ", "ุฅุฏุงุฑุฉ ุงููุธุงู")
Person(engineer, "ุงููููุฏุณ", "ุฎุฏูุงุช ุงูุชุฑููุจ")

System_Boundary(tagadodo, "ูุธุงู ุชุงุฌุง ุฏูุฏู") {
    
    Container(adminPanel, "Admin Panel", "React, TypeScript, Material-UI", "ููุญุฉ ุชุญูู ููุฅุฏุงุฑุฉ ุงููุงููุฉ")
    Container(customerWeb, "ูููุน ุงูุนููุงุก", "React, TypeScript (ูุณุชูุจูุงู)", "ูุงุฌูุฉ ููุจ ููุนููุงุก")
    Container(customerApp, "ุชุทุจูู ุงูุนููุงุก", "React Native/Flutter", "ุชุทุจูู iOS + Android")
    Container(engineerApp, "ุชุทุจูู ุงููููุฏุณูู", "React Native", "ุฅุฏุงุฑุฉ ุงูุฎุฏูุงุช ุงูููุฏุงููุฉ")
    
    Container(api, "Backend API", "NestJS, TypeScript, Node.js", "REST API - ุงูููุทู ุงูุฃุณุงุณู ูููุธุงู")
    
    ContainerDb(mongodb, "MongoDB", "NoSQL Database", "ุงูุจูุงูุงุช ุงูุฑุฆูุณูุฉ")
    ContainerDb(redis, "Redis", "In-Memory Cache", "ุงูุชุฎุฒูู ุงููุคูุช ูุงูุฌูุณุงุช")
}

System_Ext(storage, "S3 / Cloudinary", "ุชุฎุฒูู ุงููููุงุช ูุงูุตูุฑ")
System_Ext(payment, "Payment Gateway", "ูุนุงูุฌุฉ ุงูุฏูุน")
System_Ext(sms, "SMS Service", "ุฑุณุงุฆู ูุตูุฉ")
System_Ext(email, "Email Service", "ุจุฑูุฏ ุฅููุชุฑููู")
System_Ext(maps, "Google Maps", "ุฎุฑุงุฆุท ูููุงูุน")
System_Ext(firebase, "Firebase", "Push Notifications")

' ุงูุนูุงูุงุช - ุงููุณุชุฎุฏููู
Rel(admin, adminPanel, "ูุณุชุฎุฏู", "HTTPS")
Rel(customer, customerWeb, "ูุชุตูุญ", "HTTPS")
Rel(customer, customerApp, "ูุณุชุฎุฏู", "Mobile")
Rel(engineer, engineerApp, "ูุณุชุฎุฏู", "Mobile")

' ุงูุนูุงูุงุช - ุงูุชุทุจููุงุช ุฅูู API
Rel(adminPanel, api, "ูุณุชุฏุนู", "REST/HTTPS, JSON")
Rel(customerWeb, api, "ูุณุชุฏุนู", "REST/HTTPS, JSON")
Rel(customerApp, api, "ูุณุชุฏุนู", "REST/HTTPS, JSON")
Rel(engineerApp, api, "ูุณุชุฏุนู", "REST/HTTPS, JSON")

' ุงูุนูุงูุงุช - API ุฅูู ุงูุจูุงูุงุช
Rel(api, mongodb, "ููุฑุฃ ูููุชุจ", "Mongoose/TCP")
Rel(api, redis, "ูุฎุฒู ูุคูุชุงู", "ioredis/TCP")

' ุงูุนูุงูุงุช - API ุฅูู ุงูุฎุฏูุงุช ุงูุฎุงุฑุฌูุฉ
Rel(api, storage, "ูุฑูุน ุงููููุงุช", "HTTPS/API")
Rel(api, payment, "ูุทูุจ ุฏูุน", "HTTPS/API")
Rel(api, sms, "ูุฑุณู SMS", "HTTPS/API")
Rel(api, email, "ูุฑุณู Email", "SMTP/API")
Rel(api, maps, "ูุณุชุนูู", "HTTPS/API")
Rel(api, firebase, "ูุฑุณู ุฅุดุนุงุฑุงุช", "Firebase SDK")

' ุนูุณ ุงูุนูุงูุงุช
Rel_Back(payment, api, "ูุคูุฏ ุงูุฏูุน", "Webhook")

@enduml
```

---

## ๐ฆ ุชูุงุตูู ุงูุญุงููุงุช

### 1. ๐ป Admin Panel (ููุญุฉ ุชุญูู ุงูุฅุฏุงุฑุฉ)

**ุงูุชูููุงุช**:
- React 18+
- TypeScript
- Material-UI (MUI)
- React Query
- Zustand (State Management)
- React Router

**ุงููุณุคูููุงุช**:
- โ ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช ูุงููุฆุงุช ูุงูุณูุงุช
- โ ุฅุฏุงุฑุฉ ุงูุทูุจุงุช ูุชุชุจุนูุง
- โ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู ูุงูุตูุงุญูุงุช
- โ ุฅุฏุงุฑุฉ ุงูุฎุฏูุงุช ูุงูููุงุนูุฏ
- โ ุฅุฏุงุฑุฉ ุงูููุจููุงุช ูุงูุนุฑูุถ
- โ ุฅุฏุงุฑุฉ ุงูุจูุฑุงุช ูุงููุงุฑูุงุช
- โ ุงูุชุญูููุงุช ูุงูุชูุงุฑูุฑ
- โ ุฅุนุฏุงุฏุงุช ุงููุธุงู
- โ ุงูุฏุนู ุงูููู

**ุงูููุงูุฐ (Ports)**:
- **Inbound**: HTTPS (443)
- **Outbound**: API ุนูู HTTPS

**ุงูุฃูุงู**:
- JWT Authentication
- Role-Based Access (Admin/Support/Engineer)
- HTTPS Only
- CORS Protected

**ุงููุดุฑ**:
- Static Files ุนูู CDN
- Vercel / Netlify / S3 + CloudFront

---

### 2. ๐ ูููุน ุงูุนููุงุก (Customer Website)

**ุงูุญุงูุฉ**: ๐ ูุฎุทุท ูููุณุชูุจู

**ุงูุชูููุงุช**:
- React 18+ / Next.js
- TypeScript
- Tailwind CSS / MUI
- PWA Support

**ุงููุณุคูููุงุช**:
- โ ุชุตูุญ ุงูููุชุฌุงุช
- โ ุงูุจุญุซ ูุงูููุชุฑุฉ
- โ ุงูุณูุฉ ูุงูุดุฑุงุก
- โ ุชุชุจุน ุงูุทูุจุงุช
- โ ุทูุจ ุงูุฎุฏูุงุช
- โ ุงูุฏุนู ุงูููู

**ุงูููุงูุฐ**:
- **Inbound**: HTTPS (443)
- **Outbound**: API ุนูู HTTPS

**ููุฒุงุช ุฎุงุตุฉ**:
- SEO Optimized
- PWA (ูุนูู Offline ุฌุฒุฆูุงู)
- Multi-language (AR/EN)
- RTL/LTR Support

---

### 3. ๐ฑ ุชุทุจูู ุงูุนููุงุก (Customer Mobile App)

**ุงูุญุงูุฉ**: ๐ ูุฎุทุท

**ุงูุชูููุงุช**:
- **ุงูุฎูุงุฑ 1**: React Native + TypeScript
- **ุงูุฎูุงุฑ 2**: Flutter

**ุงููุณุคูููุงุช**:
- โ ุฌููุน ูุธุงุฆู ูููุน ุงูุนููุงุก
- โ Push Notifications
- โ Biometric Login
- โ Location Services
- โ Camera (ูุตูุฑ ุงูุฏุนู)
- โ Offline Mode

**ุงูููุงูุฐ**:
- **Inbound**: Push Notifications (Firebase)
- **Outbound**: API ุนูู HTTPS

**ุงูููุตุงุช**:
- iOS 13+
- Android 8+

**ููุฒุงุช ุฎุงุตุฉ**:
- Offline-First Architecture
- Background Sync
- Deep Linking
- Share Functionality

---

### 4. ๐ง ุชุทุจูู ุงููููุฏุณูู (Engineer Mobile App)

**ุงูุญุงูุฉ**: ๐ ูุฎุทุท ูููุณุชูุจู

**ุงูุชูููุงุช**:
- React Native + TypeScript

**ุงููุณุคูููุงุช**:
- โ ุนุฑุถ ุงูููุงุนูุฏ ุงููุฎุตุตุฉ
- โ ุชุญุฏูุซ ุญุงูุฉ ุงูุฎุฏูุฉ
- โ ุฅุถุงูุฉ ููุงุญุธุงุช
- โ ุฑูุน ุตูุฑ ุงูุนูู
- โ ุงูุชููู ุฅูู ุงููููุน (GPS)

**ุงูููุงูุฐ**:
- **Inbound**: Push Notifications
- **Outbound**: API ุนูู HTTPS

---

### 5. โ๏ธ Backend API (ุงูุฎูููุฉ)

**ุงูุชูููุงุช**:
- NestJS
- TypeScript
- Node.js 20+
- Express
- Mongoose (MongoDB ODM)
- ioredis (Redis Client)
- JWT
- Passport

**ุงููุณุคูููุงุช**:
- โ ุงูููุทู ุงูุฃุณุงุณู ูููุธุงู (Business Logic)
- โ ุงููุตุงุฏูุฉ ูุงูุชูููุถ
- โ ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช
- โ ุงูุชูุงูู ูุน ุงูุฎุฏูุงุช ุงูุฎุงุฑุฌูุฉ
- โ ูุนุงูุฌุฉ ุงูุทูุจุงุช
- โ ุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช
- โ ุงูุชุญูููุงุช
- โ ุงูุฃูุงู (Rate Limiting, Validation)

**ุงูููุงูุฐ**:
- **Inbound**: 
  - HTTPS (443 / 3000)
  - Webhooks (ูู Payment Gateway)
- **Outbound**:
  - MongoDB (27017)
  - Redis (6379)
  - ุฎุฏูุงุช ุฎุงุฑุฌูุฉ (HTTPS)

**ุงููุญุฏุงุช ุงููุทุจูุฉ (Modules)**:
```
Backend API (21 ูุญุฏุฉ ููุชููุฉ)
โโโ Auth (ุงููุตุงุฏูุฉ) โ
โโโ Users (ุงููุณุชุฎุฏููู) โ
โโโ Products (ุงูููุชุฌุงุช) โ
โโโ Categories (ุงููุฆุงุช) โ
โโโ Attributes (ุงูุณูุงุช) โ
โโโ Brands (ุงููุงุฑูุงุช) โ
โโโ Catalog (ุงูุนุฑุถ ุงูุนุงู) โ
โโโ Cart (ุงูุณูุฉ) โ
โโโ Checkout (ุงูุดุฑุงุก) โ
โโโ Orders (ุงูุทูุจุงุช) โ
โโโ Services (ุงูุฎุฏูุงุช) โ
โโโ Support (ุงูุฏุนู ุงูููู) โ
โโโ Notifications (ุงูุฅุดุนุงุฑุงุช) โ
โโโ Analytics (ุงูุชุญูููุงุช) โ
โโโ Marketing (ุงูุชุณููู) โ
โโโ Addresses (ุงูุนูุงููู) โ
โโโ Favorites (ุงูููุถูุฉ) โ
โโโ Search (ุงูุจุญุซ) โ
โโโ Security (ุงูุฃูุงู) โ
โโโ Exchange Rates (ุฃุณุนุงุฑ ุงูุตุฑู) โ
โโโ Upload (ุฑูุน ุงููููุงุช) โ
```

**ุงูุฃูุงู**:
- JWT + Refresh Tokens
- Role-Based Access Control (RBAC)
- Rate Limiting (Redis)
- Input Validation (class-validator)
- CORS Configuration
- Helmet Security Headers
- XSS Protection
- SQL Injection Protection (Mongoose)

**ุงูุฃุฏุงุก**:
- Redis Caching
- Database Indexing
- Query Optimization
- Response Compression
- Pagination

**ุงูุชูุซูู**:
- Swagger / OpenAPI ุนูู `/docs`
- Auto-generated ูู Decorators

---

### 6. ๐ MongoDB (ูุงุนุฏุฉ ุงูุจูุงูุงุช)

**ุงูููุน**: NoSQL Document Database

**ุงูุงุณุชุฎุฏุงู**:
- ุงูุจูุงูุงุช ุงูุฑุฆูุณูุฉ ูููุธุงู
- ุงูููุชุฌุงุช ูุงููุฆุงุช
- ุงูุทูุจุงุช ูุงูุฎุฏูุงุช
- ุงููุณุชุฎุฏููู ูุงูุตูุงุญูุงุช
- ุงูุฅุดุนุงุฑุงุช ูุงูุฏุนู

**ุงููุฌููุนุงุช ุงูุฑุฆูุณูุฉ (Collections)**:
```
MongoDB
โโโ users
โโโ products
โโโ categories
โโโ attributes
โโโ brands
โโโ orders
โโโ services
โโโ cart
โโโ favorites
โโโ addresses
โโโ coupons
โโโ promotions
โโโ notifications
โโโ support-tickets
โโโ banners
โโโ analytics-events
```

**ุงูููุฒุงุช**:
- Indexes ููุฃุฏุงุก
- Transactions ููุนูููุงุช ุงูุญุฑุฌุฉ
- TTL Indexes ููุจูุงูุงุช ุงููุคูุชุฉ
- Text Indexes ููุจุญุซ
- Geo Indexes ููููุงูุน

**ุงููุดุฑ**:
- MongoDB Atlas (Cloud)
- ุฃู Self-Hosted

**ุงููุณุฎ ุงูุงุญุชูุงุทู**:
- ูุณุฎ ุงุญุชูุงุทู ุชููุงุฆู ูููู
- Point-in-Time Recovery

---

### 7. ๐ด Redis (ุงูุชุฎุฒูู ุงููุคูุช)

**ุงูููุน**: In-Memory Data Store

**ุงูุงุณุชุฎุฏุงู**:
- ุงูุฌูุณุงุช (Sessions)
- ุงูุชุฎุฒูู ุงููุคูุช (Cache)
- Rate Limiting
- Queue (ููููุงู ุงูุฎูููุฉ)
- Real-time Data

**ุงูุจูุงูุงุช ุงููุฎุฒูุฉ**:
- `session:*` - ุฌูุณุงุช ุงููุณุชุฎุฏููู
- `cache:product:*` - ุงูููุชุฌุงุช ุงููุคูุชุฉ
- `cache:category:*` - ุงููุฆุงุช ุงููุคูุชุฉ
- `ratelimit:*` - ุนุฏุงุฏุงุช Rate Limiting
- `queue:*` - ุทูุงุจูุฑ ุงูููุงู

**TTL (Time To Live)**:
- Sessions: 7 ุฃูุงู
- Product Cache: 1 ุณุงุนุฉ
- Rate Limit: 15 ุฏูููุฉ

**ุงููุดุฑ**:
- Redis Cloud
- ุฃู Self-Hosted

---

## ๐ ุชุฏูู ุงูุจูุงูุงุช

### ุณููุงุฑูู 1: ุนููู ูุชุตูุญ ุงูููุชุฌุงุช

```mermaid
sequenceDiagram
    participant C as ๐ฑ Customer App
    participant A as โ๏ธ API
    participant R as ๐ด Redis
    participant M as ๐ MongoDB
    participant S as ๐๏ธ S3

    C->>A: GET /api/products?category=solar-panels
    A->>R: ุชุญูู ูู Cache
    
    alt Cache Hit
        R-->>A: ููุชุฌุงุช ูู Cache
    else Cache Miss
        A->>M: ุงุณุชุนูุงู ุงูููุชุฌุงุช
        M-->>A: ุจูุงูุงุช ุงูููุชุฌุงุช
        A->>R: ุญูุธ ูู Cache (1 ุณุงุนุฉ)
    end
    
    A->>S: ุชูููุฏ URLs ูููุนุฉ ููุตูุฑ
    S-->>A: URLs ุงูุตูุฑ
    
    A-->>C: JSON: ุงูููุชุฌุงุช + ุตูุฑ
```

---

### ุณููุงุฑูู 2: ุนููู ูุดุชุฑู ููุชุฌ

```mermaid
sequenceDiagram
    participant C as ๐ฑ Customer App
    participant A as โ๏ธ API
    participant M as ๐ MongoDB
    participant P as ๐ณ Payment Gateway
    participant SM as ๐ฑ SMS
    participant E as ๐ง Email
    participant F as ๐ Firebase

    C->>A: POST /api/checkout
    A->>M: ุฅูุดุงุก ุทูุจ (ุญุงูุฉ: pending)
    M-->>A: ุชุฃููุฏ ุงูุฅูุดุงุก
    
    A->>P: ุทูุจ ุฌูุณุฉ ุฏูุน
    P-->>A: payment_url
    A-->>C: payment_url
    
    C->>P: ุงูุนููู ูุฏูุน
    P->>A: Webhook: payment_success
    
    A->>M: ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ (paid)
    A->>SM: ุฅุฑุณุงู SMS ุชุฃููุฏ
    A->>E: ุฅุฑุณุงู Email ูุงุชูุฑุฉ
    A->>F: Push Notification
    
    A-->>C: ุชุฃููุฏ ุงูุทูุจ
```

---

### ุณููุงุฑูู 3: ูุฏูุฑ ูุถูู ููุชุฌ

```mermaid
sequenceDiagram
    participant Ad as ๐ป Admin Panel
    participant A as โ๏ธ API
    participant S as ๐๏ธ S3
    participant M as ๐ MongoDB
    participant R as ๐ด Redis

    Ad->>A: POST /api/admin/products
    Note over Ad,A: ุจูุงูุงุช ุงูููุชุฌ + ุตูุฑ
    
    A->>A: Validation
    A->>S: ุฑูุน ุงูุตูุฑ
    S-->>A: URLs ุงูุตูุฑ
    
    A->>M: ุญูุธ ุงูููุชุฌ
    M-->>A: ุชุฃููุฏ ุงูุญูุธ
    
    A->>R: ุฅูุบุงุก Cache ุงูููุชุฌุงุช
    
    A-->>Ad: ุชุฃููุฏ ุงููุฌุงุญ
```

---

## ๐ ุงูุฃูุงู ุจูู ุงูุญุงููุงุช

### 1. ุงูุชุทุจููุงุช โ API

**ุงููุตุงุฏูุฉ**:
```
Authorization: Bearer <JWT_TOKEN>
```

**ุงูุชุญูู**:
- JWT Signature Verification
- Token Expiry Check
- User Active Check

**ุงูุชุดููุฑ**:
- HTTPS Only (TLS 1.3)
- Certificate Pinning (Mobile Apps)

---

### 2. API โ MongoDB

**ุงููุตุงุฏูุฉ**:
- Username + Password
- IP Whitelist

**ุงูุชุดููุฑ**:
- TLS/SSL Connection
- Data at Rest Encryption

---

### 3. API โ Redis

**ุงููุตุงุฏูุฉ**:
- Password (Redis AUTH)
- IP Whitelist

**ุงูุชุดููุฑ**:
- TLS Connection (Production)

---

### 4. API โ External Services

**ุงููุตุงุฏูุฉ**:
- API Keys
- OAuth (ุจุนุถ ุงูุฎุฏูุงุช)
- Webhooks Secret

**ุงูุชุญูู**:
- Webhook Signature Verification
- IP Whitelist (Webhooks)

---

## ๐ ุงูุชูุณุน ูุงูุฃุฏุงุก

### Horizontal Scaling

```mermaid
graph LR
    LB[โ๏ธ Load Balancer<br/>Nginx/ALB]
    
    API1[โ๏ธ API Instance 1]
    API2[โ๏ธ API Instance 2]
    API3[โ๏ธ API Instance 3]
    
    Redis[๐ด Redis<br/>Shared Sessions]
    MongoDB[๐ MongoDB<br/>Replica Set]
    
    LB --> API1
    LB --> API2
    LB --> API3
    
    API1 --> Redis
    API2 --> Redis
    API3 --> Redis
    
    API1 --> MongoDB
    API2 --> MongoDB
    API3 --> MongoDB
```

### ุงุณุชุฑุงุชูุฌูุฉ ุงูุชูุณุน:

1. **API Scaling**:
   - Docker Containers
   - Kubernetes (ูุณุชูุจูุงู)
   - Auto-scaling ุจูุงุกู ุนูู CPU/Memory

2. **Database Scaling**:
   - MongoDB Replica Set (Read Replicas)
   - Sharding (ุนูุฏ ุงูุญุงุฌุฉ)

3. **Cache Scaling**:
   - Redis Cluster
   - Cache Layers (L1: Memory, L2: Redis)

4. **Storage Scaling**:
   - CDN ููุตูุฑ (CloudFront)
   - Multiple S3 Buckets

---

## ๐ ุงููุดุฑ (Deployment)

### Development
```
Frontend: localhost:5173
Backend API: localhost:3000
MongoDB: localhost:27017
Redis: localhost:6379
```

### Staging
```
Frontend: staging-admin.tagadodo.com
Backend API: staging-api.tagadodo.com
MongoDB: MongoDB Atlas (Staging Cluster)
Redis: Redis Cloud (Staging)
```

### Production
```
Frontend: admin.tagadodo.com
Backend API: api.tagadodo.com
Customer Web: tagadodo.com (ูุณุชูุจูุงู)
Mobile Apps: App Store + Google Play
MongoDB: MongoDB Atlas (Production Cluster)
Redis: Redis Cloud (Production)
```

---

## ๐ ุงูุฅุญุตุงุฆูุงุช ุงููุชููุนุฉ

### ุญุฌู ุงูุญุงููุงุช:

| Container | Memory | CPU | Storage |
|-----------|--------|-----|---------|
| Admin Panel | - | - | ~50 MB (Static) |
| Customer App | - | - | ~100 MB (Download) |
| Backend API | 512 MB - 2 GB | 1-2 vCPU | Minimal |
| MongoDB | 2-8 GB | 2-4 vCPU | 50-500 GB |
| Redis | 512 MB - 2 GB | 1 vCPU | 1-10 GB |

### ุงูุงุณุชุฎุฏุงู ุงููุชููุน:

| Metric | Development | Production |
|--------|-------------|------------|
| API Requests/sec | 1-10 | 100-1000 |
| Concurrent Users | 1-5 | 500-5000 |
| Database Queries/sec | 10-50 | 1000-5000 |
| Cache Hit Rate | - | 80-90% |

---

## ๐ ููุงุญุธุงุช ุชูููุฉ

### 1. Multi-tenancy
- ุญุงููุงู: Single Tenant
- ูุณุชูุจูุงู: ูููู ุฅุถุงูุฉ Multi-tenancy

### 2. Real-time Features
- ุญุงููุงู: Polling
- ูุณุชูุจูุงู: WebSockets / Server-Sent Events

### 3. GraphQL
- ุญุงููุงู: REST API
- ูุณุชูุจูุงู: GraphQL ูุฎูุงุฑ ุฅุถุงูู

### 4. Message Queue
- ุญุงููุงู: Redis Queue
- ูุณุชูุจูุงู: RabbitMQ / Apache Kafka

---

---

## ๐ ููุฎุต ุงูุชุญุฏูุซุงุช

### โ ุงูุชุญุฏูุซุงุช ุงููุทุจูุฉ:
1. **ุชุญุฏูุซ ูุตู Admin Panel**: ุฅุถุงูุฉ ุงูููุฒุงุช ุงููุทุจูุฉ ูุนููุงู
2. **ุชุญุฏูุซ ูุงุฆูุฉ ุงููุญุฏุงุช**: ูู 10 ูุญุฏุงุช ุฅูู 21 ูุญุฏุฉ ููุชููุฉ
3. **ุฅุถุงูุฉ ุงููุญุฏุงุช ุงูุฌุฏูุฏุฉ**: Exchange Rates, Upload, Security, Marketing
4. **ุชุญุฏูุซ ุญุงูุฉ ุงูุชุทููุฑ**: ุฌููุน ุงููุญุฏุงุช ููุชููุฉ ููุทุจูุฉ
5. **ุชุญุฏูุซ ุงูุฃูุงู**: ูุธุงู ุฃูุงู ูุชูุฏู ูุน Rate Limiting ูCORS

### ๐ ุงูุฅุญุตุงุฆูุงุช ุงููุญุฏุซุฉ:
- **ุงููุญุฏุงุช ุงููุทุจูุฉ**: 21/21 (100%)
- **Admin Panel**: ููุชูู ุจุงููุงูู ูุน ุฌููุน ุงูููุฒุงุช
- **Backend API**: ููุชูู ูุน ุฌููุน ุงููุญุฏุงุช
- **ูุงุนุฏุฉ ุงูุจูุงูุงุช**: MongoDB ูุน Redis ููุชุฎุฒูู ุงููุคูุช
- **ูุธุงู ุงูุฃูุงู**: ูุชูุฏู ูุน ุญูุงูุฉ ุดุงููุฉ

---

**ุงูุณุงุจู**: [โ Level 1 - System Context](./01-system-context.md)  
**ุงูุชุงูู**: [Level 3 - Component Diagram โ](./03-component-diagram.md)

