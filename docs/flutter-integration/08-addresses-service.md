# ğŸ“ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† (Addresses Service)

Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ØªÙˆÙØ± endpoints Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„ØªÙˆØµÙŠÙ„ Ù…Ø¹ Ø¯Ø¹Ù… Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª ÙˆØ§Ù„Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø®ØªÙ„ÙØ©.

---

## ğŸ“‹ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª

1. [Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†](#1-Ù‚Ø§Ø¦Ù…Ø©-Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†)
2. [Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù†Ø´Ø·Ø©](#2-Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†-Ø§Ù„Ù†Ø´Ø·Ø©)
3. [Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ](#3-Ø§Ù„Ø¹Ù†ÙˆØ§Ù†-Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ)
4. [Ø¹Ù†ÙˆØ§Ù† Ù…Ø­Ø¯Ø¯](#4-Ø¹Ù†ÙˆØ§Ù†-Ù…Ø­Ø¯Ø¯)
5. [Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ÙˆØ§Ù† Ø¬Ø¯ÙŠØ¯](#5-Ø¥Ù†Ø´Ø§Ø¡-Ø¹Ù†ÙˆØ§Ù†-Ø¬Ø¯ÙŠØ¯)
6. [ØªØ­Ø¯ÙŠØ« Ø¹Ù†ÙˆØ§Ù†](#6-ØªØ­Ø¯ÙŠØ«-Ø¹Ù†ÙˆØ§Ù†)
7. [Ø­Ø°Ù Ø¹Ù†ÙˆØ§Ù†](#7-Ø­Ø°Ù-Ø¹Ù†ÙˆØ§Ù†)
8. [ØªØ¹ÙŠÙŠÙ† ÙƒØ¹Ù†ÙˆØ§Ù† Ø§ÙØªØ±Ø§Ø¶ÙŠ](#8-ØªØ¹ÙŠÙŠÙ†-ÙƒØ¹Ù†ÙˆØ§Ù†-Ø§ÙØªØ±Ø§Ø¶ÙŠ)
9. [Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¹Ù†ÙˆØ§Ù† Ù…Ø­Ø°ÙˆÙ](#9-Ø§Ø³ØªØ¹Ø§Ø¯Ø©-Ø¹Ù†ÙˆØ§Ù†-Ù…Ø­Ø°ÙˆÙ)
10. [Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ù„ÙƒÙŠØ©](#10-Ø§Ù„ØªØ­Ù‚Ù‚-Ù…Ù†-Ø§Ù„Ù…Ù„ÙƒÙŠØ©)
11. [Models ÙÙŠ Flutter](#models-ÙÙŠ-flutter)

---

## 1. Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†

ÙŠØ³ØªØ±Ø¬Ø¹ Ø¬Ù…ÙŠØ¹ Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø¹ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© ØªØ¶Ù…ÙŠÙ† Ø§Ù„Ù…Ø­Ø°ÙˆÙØ©.

### Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨

- **Method:** `GET`
- **Endpoint:** `/addresses`
- **Auth Required:** âœ… Ù†Ø¹Ù…
- **Cache:** âŒ Ù„Ø§

### Query Parameters

| Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ | Ø§Ù„Ù†ÙˆØ¹ | Ù…Ø·Ù„ÙˆØ¨ | Ø§Ù„ÙˆØµÙ |
|---------|------|-------|-------|
| `includeDeleted` | `boolean` | âŒ | ØªØ¶Ù…ÙŠÙ† Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù…Ø­Ø°ÙˆÙØ© |

### Response - Ù†Ø¬Ø§Ø­

```json
{
  "success": true,
  "data": [
    {
      "_id": "64addr123",
      "userId": "64user456",
      "label": "Ø§Ù„Ù…Ù†Ø²Ù„",
      "addressType": "home",
      "recipientName": "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯",
      "recipientPhone": "773123456",
      "line1": "Ø´Ø§Ø±Ø¹ Ø§Ù„Ø³ØªÙŠÙ†ØŒ Ø¨Ø¬ÙˆØ§Ø± Ù…Ø·Ø¹Ù… Ø§Ù„Ø³Ù„Ø·Ø§Ù†",
      "line2": "Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«ØŒ Ø´Ù‚Ø© 12",
      "city": "ØµÙ†Ø¹Ø§Ø¡",
      "region": "Ø­ÙŠ Ø§Ù„Ø³Ø¨Ø¹ÙŠÙ†",
      "country": "Yemen",
      "postalCode": "12345",
      "coords": {
        "lat": 15.3694,
        "lng": 44.1910
      },
      "notes": "ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¹Ù†Ø¯ Ø§Ù„ÙˆØµÙˆÙ„",
      "isDefault": true,
      "isActive": true,
      "placeId": "ChIJd8BlQ2BZwokRAFUEcm_qrcA",
      "lastUsedAt": "2025-01-15T10:00:00.000Z",
      "usageCount": 15,
      "createdAt": "2025-01-01T00:00:00.000Z",
      "updatedAt": "2025-01-15T10:00:00.000Z"
    }
  ],
  "count": 1,
  "requestId": "req_addr_001"
}
```

### ÙƒÙˆØ¯ Flutter

```dart
Future<List<Address>> getAddresses({bool includeDeleted = false}) async {
  final response = await _dio.get(
    '/addresses',
    queryParameters: {
      if (includeDeleted) 'includeDeleted': 'true',
    },
  );

  final apiResponse = ApiResponse<List<Address>>.fromJson(
    response.data,
    (json) => ((json as Map<String, dynamic>)['data'] as List)
        .map((item) => Address.fromJson(item))
        .toList(),
  );

  if (apiResponse.isSuccess) {
    return apiResponse.data!;
  } else {
    throw ApiException(apiResponse.error!);
  }
}
```

---

## 2. Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù†Ø´Ø·Ø©

ÙŠØ³ØªØ±Ø¬Ø¹ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù†Ø´Ø·Ø© ÙÙ‚Ø· (ØºÙŠØ± Ø§Ù„Ù…Ø­Ø°ÙˆÙØ©).

### Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨

- **Method:** `GET`
- **Endpoint:** `/addresses/active`
- **Auth Required:** âœ… Ù†Ø¹Ù…
- **Cache:** âŒ Ù„Ø§

### Response - Ù†Ø¬Ø§Ø­

```json
{
  "success": true,
  "data": [
    {
      "_id": "64addr123",
      "userId": "64user456",
      "label": "Ø§Ù„Ù…Ù†Ø²Ù„",
      "addressType": "home",
      "recipientName": "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯",
      "recipientPhone": "773123456",
      "line1": "Ø´Ø§Ø±Ø¹ Ø§Ù„Ø³ØªÙŠÙ†ØŒ Ø¨Ø¬ÙˆØ§Ø± Ù…Ø·Ø¹Ù… Ø§Ù„Ø³Ù„Ø·Ø§Ù†",
      "line2": "Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«ØŒ Ø´Ù‚Ø© 12",
      "city": "ØµÙ†Ø¹Ø§Ø¡",
      "region": "Ø­ÙŠ Ø§Ù„Ø³Ø¨Ø¹ÙŠÙ†",
      "country": "Yemen",
      "postalCode": "12345",
      "coords": {
        "lat": 15.3694,
        "lng": 44.1910
      },
      "notes": "ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¹Ù†Ø¯ Ø§Ù„ÙˆØµÙˆÙ„",
      "isDefault": true,
      "isActive": true,
      "placeId": "ChIJd8BlQ2BZwokRAFUEcm_qrcA",
      "lastUsedAt": "2025-01-15T10:00:00.000Z",
      "usageCount": 15,
      "createdAt": "2025-01-01T00:00:00.000Z",
      "updatedAt": "2025-01-15T10:00:00.000Z"
    }
  ],
  "count": 1,
  "requestId": "req_addr_002"
}
```

### ÙƒÙˆØ¯ Flutter

```dart
Future<List<Address>> getActiveAddresses() async {
  final response = await _dio.get('/addresses/active');

  final apiResponse = ApiResponse<List<Address>>.fromJson(
    response.data,
    (json) => ((json as Map<String, dynamic>)['data'] as List)
        .map((item) => Address.fromJson(item))
        .toList(),
  );

  if (apiResponse.isSuccess) {
    return apiResponse.data!;
  } else {
    throw ApiException(apiResponse.error!);
  }
}
```

---

## 3. Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ

ÙŠØ³ØªØ±Ø¬Ø¹ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù….

### Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨

- **Method:** `GET`
- **Endpoint:** `/addresses/default`
- **Auth Required:** âœ… Ù†Ø¹Ù…
- **Cache:** âŒ Ù„Ø§

### Response - Ù†Ø¬Ø§Ø­

```json
{
  "success": true,
  "data": {
    "_id": "64addr123",
    "userId": "64user456",
    "label": "Ø§Ù„Ù…Ù†Ø²Ù„",
    "addressType": "home",
    "recipientName": "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯",
    "recipientPhone": "773123456",
    "line1": "Ø´Ø§Ø±Ø¹ Ø§Ù„Ø³ØªÙŠÙ†ØŒ Ø¨Ø¬ÙˆØ§Ø± Ù…Ø·Ø¹Ù… Ø§Ù„Ø³Ù„Ø·Ø§Ù†",
    "line2": "Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«ØŒ Ø´Ù‚Ø© 12",
    "city": "ØµÙ†Ø¹Ø§Ø¡",
    "region": "Ø­ÙŠ Ø§Ù„Ø³Ø¨Ø¹ÙŠÙ†",
    "country": "Yemen",
    "postalCode": "12345",
    "coords": {
      "lat": 15.3694,
      "lng": 44.1910
    },
    "notes": "ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¹Ù†Ø¯ Ø§Ù„ÙˆØµÙˆÙ„",
    "isDefault": true,
    "isActive": true,
    "placeId": "ChIJd8BlQ2BZwokRAFUEcm_qrcA",
    "lastUsedAt": "2025-01-15T10:00:00.000Z",
    "usageCount": 15,
    "createdAt": "2025-01-01T00:00:00.000Z",
    "updatedAt": "2025-01-15T10:00:00.000Z"
  },
  "requestId": "req_addr_003"
}
```

### Response - Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù†ÙˆØ§Ù† Ø§ÙØªØ±Ø§Ø¶ÙŠ

```json
{
  "success": false,
  "message": "No addresses found. Please add an address first.",
  "data": null,
  "requestId": "req_addr_003"
}
```

### ÙƒÙˆØ¯ Flutter

```dart
Future<Address?> getDefaultAddress() async {
  final response = await _dio.get('/addresses/default');

  final apiResponse = ApiResponse<Address?>.fromJson(
    response.data,
    (json) => (json as Map<String, dynamic>)['data'] != null
        ? Address.fromJson((json as Map<String, dynamic>)['data'])
        : null,
  );

  if (apiResponse.isSuccess) {
    return apiResponse.data;
  } else {
    throw ApiException(apiResponse.error!);
  }
}
```

---

## 4. Ø¹Ù†ÙˆØ§Ù† Ù…Ø­Ø¯Ø¯

ÙŠØ³ØªØ±Ø¬Ø¹ Ø¹Ù†ÙˆØ§Ù† Ù…Ø­Ø¯Ø¯ Ø¨Ø§Ù„Ù€ ID.

### Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨

- **Method:** `GET`
- **Endpoint:** `/addresses/:id`
- **Auth Required:** âœ… Ù†Ø¹Ù…
- **Cache:** âŒ Ù„Ø§

### Response - Ù†Ø¬Ø§Ø­

```json
{
  "success": true,
  "data": {
    "_id": "64addr123",
    "userId": "64user456",
    "label": "Ø§Ù„Ù…Ù†Ø²Ù„",
    "addressType": "home",
    "recipientName": "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯",
    "recipientPhone": "773123456",
    "line1": "Ø´Ø§Ø±Ø¹ Ø§Ù„Ø³ØªÙŠÙ†ØŒ Ø¨Ø¬ÙˆØ§Ø± Ù…Ø·Ø¹Ù… Ø§Ù„Ø³Ù„Ø·Ø§Ù†",
    "line2": "Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«ØŒ Ø´Ù‚Ø© 12",
    "city": "ØµÙ†Ø¹Ø§Ø¡",
    "region": "Ø­ÙŠ Ø§Ù„Ø³Ø¨Ø¹ÙŠÙ†",
    "country": "Yemen",
    "postalCode": "12345",
    "coords": {
      "lat": 15.3694,
      "lng": 44.1910
    },
    "notes": "ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¹Ù†Ø¯ Ø§Ù„ÙˆØµÙˆÙ„",
    "isDefault": true,
    "isActive": true,
    "placeId": "ChIJd8BlQ2BZwokRAFUEcm_qrcA",
    "lastUsedAt": "2025-01-15T10:00:00.000Z",
    "usageCount": 15,
    "createdAt": "2025-01-01T00:00:00.000Z",
    "updatedAt": "2025-01-15T10:00:00.000Z"
  },
  "requestId": "req_addr_004"
}
```

### ÙƒÙˆØ¯ Flutter

```dart
Future<Address> getAddress(String id) async {
  final response = await _dio.get('/addresses/$id');

  final apiResponse = ApiResponse<Address>.fromJson(
    response.data,
    (json) => Address.fromJson((json as Map<String, dynamic>)['data']),
  );

  if (apiResponse.isSuccess) {
    return apiResponse.data!;
  } else {
    throw ApiException(apiResponse.error!);
  }
}
```

---

## 5. Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ÙˆØ§Ù† Ø¬Ø¯ÙŠØ¯

ÙŠÙ†Ø´Ø¦ Ø¹Ù†ÙˆØ§Ù† Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù….

### Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨

- **Method:** `POST`
- **Endpoint:** `/addresses`
- **Auth Required:** âœ… Ù†Ø¹Ù…
- **Cache:** âŒ Ù„Ø§

### Request Body

```json
{
  "label": "Ø§Ù„Ù…Ù†Ø²Ù„",
  "addressType": "home",
  "recipientName": "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯",
  "recipientPhone": "773123456",
  "line1": "Ø´Ø§Ø±Ø¹ Ø§Ù„Ø³ØªÙŠÙ†ØŒ Ø¨Ø¬ÙˆØ§Ø± Ù…Ø·Ø¹Ù… Ø§Ù„Ø³Ù„Ø·Ø§Ù†",
  "line2": "Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«ØŒ Ø´Ù‚Ø© 12",
  "city": "ØµÙ†Ø¹Ø§Ø¡",
  "region": "Ø­ÙŠ Ø§Ù„Ø³Ø¨Ø¹ÙŠÙ†",
  "country": "Yemen",
  "postalCode": "12345",
  "coords": {
    "lat": 15.3694,
    "lng": 44.1910
  },
  "notes": "ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¹Ù†Ø¯ Ø§Ù„ÙˆØµÙˆÙ„",
  "isDefault": true,
  "placeId": "ChIJd8BlQ2BZwokRAFUEcm_qrcA"
}
```

### Response - Ù†Ø¬Ø§Ø­

```json
{
  "success": true,
  "message": "Address created successfully",
  "data": {
    "_id": "64addr123",
    "userId": "64user456",
    "label": "Ø§Ù„Ù…Ù†Ø²Ù„",
    "addressType": "home",
    "recipientName": "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯",
    "recipientPhone": "773123456",
    "line1": "Ø´Ø§Ø±Ø¹ Ø§Ù„Ø³ØªÙŠÙ†ØŒ Ø¨Ø¬ÙˆØ§Ø± Ù…Ø·Ø¹Ù… Ø§Ù„Ø³Ù„Ø·Ø§Ù†",
    "line2": "Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«ØŒ Ø´Ù‚Ø© 12",
    "city": "ØµÙ†Ø¹Ø§Ø¡",
    "region": "Ø­ÙŠ Ø§Ù„Ø³Ø¨Ø¹ÙŠÙ†",
    "country": "Yemen",
    "postalCode": "12345",
    "coords": {
      "lat": 15.3694,
      "lng": 44.1910
    },
    "notes": "ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¹Ù†Ø¯ Ø§Ù„ÙˆØµÙˆÙ„",
    "isDefault": true,
    "isActive": true,
    "placeId": "ChIJd8BlQ2BZwokRAFUEcm_qrcA",
    "usageCount": 0,
    "createdAt": "2025-01-15T10:00:00.000Z",
    "updatedAt": "2025-01-15T10:00:00.000Z"
  },
  "requestId": "req_addr_005"
}
```

### ÙƒÙˆØ¯ Flutter

```dart
Future<Address> createAddress({
  required String label,
  required String recipientName,
  required String recipientPhone,
  required String line1,
  required String city,
  String? addressType,
  String? line2,
  String? region,
  String? country,
  String? postalCode,
  AddressCoords? coords,
  String? notes,
  bool isDefault = false,
  String? placeId,
}) async {
  final response = await _dio.post('/addresses', data: {
    'label': label,
    'addressType': addressType ?? 'home',
    'recipientName': recipientName,
    'recipientPhone': recipientPhone,
    'line1': line1,
    if (line2 != null) 'line2': line2,
    'city': city,
    if (region != null) 'region': region,
    if (country != null) 'country': country,
    if (postalCode != null) 'postalCode': postalCode,
    if (coords != null) 'coords': coords.toJson(),
    if (notes != null) 'notes': notes,
    'isDefault': isDefault,
    if (placeId != null) 'placeId': placeId,
  });

  final apiResponse = ApiResponse<Address>.fromJson(
    response.data,
    (json) => Address.fromJson((json as Map<String, dynamic>)['data']),
  );

  if (apiResponse.isSuccess) {
    return apiResponse.data!;
  } else {
    throw ApiException(apiResponse.error!);
  }
}
```

---

## 6. ØªØ­Ø¯ÙŠØ« Ø¹Ù†ÙˆØ§Ù†

ÙŠØ­Ø¯Ø« Ø¹Ù†ÙˆØ§Ù† Ù…ÙˆØ¬ÙˆØ¯.

### Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨

- **Method:** `PATCH`
- **Endpoint:** `/addresses/:id`
- **Auth Required:** âœ… Ù†Ø¹Ù…
- **Cache:** âŒ Ù„Ø§

### Request Body

```json
{
  "label": "Ø§Ù„Ù…Ù†Ø²Ù„ Ø§Ù„Ø¬Ø¯ÙŠØ¯",
  "recipientName": "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯",
  "recipientPhone": "773123456",
  "line1": "Ø´Ø§Ø±Ø¹ Ø§Ù„Ø³ØªÙŠÙ†ØŒ Ø¨Ø¬ÙˆØ§Ø± Ù…Ø·Ø¹Ù… Ø§Ù„Ø³Ù„Ø·Ø§Ù†",
  "line2": "Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«ØŒ Ø´Ù‚Ø© 12",
  "city": "ØµÙ†Ø¹Ø§Ø¡",
  "region": "Ø­ÙŠ Ø§Ù„Ø³Ø¨Ø¹ÙŠÙ†",
  "notes": "ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¹Ù†Ø¯ Ø§Ù„ÙˆØµÙˆÙ„",
  "isDefault": true
}
```

### Response - Ù†Ø¬Ø§Ø­

```json
{
  "success": true,
  "message": "Address updated successfully",
  "data": {
    "_id": "64addr123",
    "userId": "64user456",
    "label": "Ø§Ù„Ù…Ù†Ø²Ù„ Ø§Ù„Ø¬Ø¯ÙŠØ¯",
    "addressType": "home",
    "recipientName": "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯",
    "recipientPhone": "773123456",
    "line1": "Ø´Ø§Ø±Ø¹ Ø§Ù„Ø³ØªÙŠÙ†ØŒ Ø¨Ø¬ÙˆØ§Ø± Ù…Ø·Ø¹Ù… Ø§Ù„Ø³Ù„Ø·Ø§Ù†",
    "line2": "Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«ØŒ Ø´Ù‚Ø© 12",
    "city": "ØµÙ†Ø¹Ø§Ø¡",
    "region": "Ø­ÙŠ Ø§Ù„Ø³Ø¨Ø¹ÙŠÙ†",
    "country": "Yemen",
    "postalCode": "12345",
    "coords": {
      "lat": 15.3694,
      "lng": 44.1910
    },
    "notes": "ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¹Ù†Ø¯ Ø§Ù„ÙˆØµÙˆÙ„",
    "isDefault": true,
    "isActive": true,
    "placeId": "ChIJd8BlQ2BZwokRAFUEcm_qrcA",
    "lastUsedAt": "2025-01-15T10:00:00.000Z",
    "usageCount": 15,
    "createdAt": "2025-01-01T00:00:00.000Z",
    "updatedAt": "2025-01-15T11:00:00.000Z"
  },
  "requestId": "req_addr_006"
}
```

### ÙƒÙˆØ¯ Flutter

```dart
Future<Address> updateAddress({
  required String id,
  String? label,
  String? addressType,
  String? recipientName,
  String? recipientPhone,
  String? line1,
  String? line2,
  String? city,
  String? region,
  String? country,
  String? postalCode,
  AddressCoords? coords,
  String? notes,
  bool? isDefault,
  bool? isActive,
  String? placeId,
}) async {
  final data = <String, dynamic>{};
  if (label != null) data['label'] = label;
  if (addressType != null) data['addressType'] = addressType;
  if (recipientName != null) data['recipientName'] = recipientName;
  if (recipientPhone != null) data['recipientPhone'] = recipientPhone;
  if (line1 != null) data['line1'] = line1;
  if (line2 != null) data['line2'] = line2;
  if (city != null) data['city'] = city;
  if (region != null) data['region'] = region;
  if (country != null) data['country'] = country;
  if (postalCode != null) data['postalCode'] = postalCode;
  if (coords != null) data['coords'] = coords.toJson();
  if (notes != null) data['notes'] = notes;
  if (isDefault != null) data['isDefault'] = isDefault;
  if (isActive != null) data['isActive'] = isActive;
  if (placeId != null) data['placeId'] = placeId;

  final response = await _dio.patch('/addresses/$id', data: data);

  final apiResponse = ApiResponse<Address>.fromJson(
    response.data,
    (json) => Address.fromJson((json as Map<String, dynamic>)['data']),
  );

  if (apiResponse.isSuccess) {
    return apiResponse.data!;
  } else {
    throw ApiException(apiResponse.error!);
  }
}
```

---

## 7. Ø­Ø°Ù Ø¹Ù†ÙˆØ§Ù†

ÙŠØ­Ø°Ù Ø¹Ù†ÙˆØ§Ù† (Ø­Ø°Ù Ù†Ø§Ø¹Ù…).

### Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨

- **Method:** `DELETE`
- **Endpoint:** `/addresses/:id`
- **Auth Required:** âœ… Ù†Ø¹Ù…
- **Cache:** âŒ Ù„Ø§

### Response - Ù†Ø¬Ø§Ø­

```json
{
  "success": true,
  "message": "Address deleted successfully",
  "data": {
    "deleted": true,
    "addressId": "64addr123"
  },
  "requestId": "req_addr_007"
}
```

### ÙƒÙˆØ¯ Flutter

```dart
Future<bool> deleteAddress(String id) async {
  final response = await _dio.delete('/addresses/$id');

  final apiResponse = ApiResponse<Map<String, dynamic>>.fromJson(
    response.data,
    (json) => (json as Map<String, dynamic>)['data'],
  );

  if (apiResponse.isSuccess) {
    return apiResponse.data!['deleted'] ?? false;
  } else {
    throw ApiException(apiResponse.error!);
  }
}
```

---

## 8. ØªØ¹ÙŠÙŠÙ† ÙƒØ¹Ù†ÙˆØ§Ù† Ø§ÙØªØ±Ø§Ø¶ÙŠ

ÙŠØ¹ÙŠÙ† Ø¹Ù†ÙˆØ§Ù† ÙƒØ§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù….

### Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨

- **Method:** `POST`
- **Endpoint:** `/addresses/:id/set-default`
- **Auth Required:** âœ… Ù†Ø¹Ù…
- **Cache:** âŒ Ù„Ø§

### Response - Ù†Ø¬Ø§Ø­

```json
{
  "success": true,
  "message": "Default address set successfully",
  "data": {
    "_id": "64addr123",
    "userId": "64user456",
    "label": "Ø§Ù„Ù…Ù†Ø²Ù„",
    "addressType": "home",
    "recipientName": "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯",
    "recipientPhone": "773123456",
    "line1": "Ø´Ø§Ø±Ø¹ Ø§Ù„Ø³ØªÙŠÙ†ØŒ Ø¨Ø¬ÙˆØ§Ø± Ù…Ø·Ø¹Ù… Ø§Ù„Ø³Ù„Ø·Ø§Ù†",
    "line2": "Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«ØŒ Ø´Ù‚Ø© 12",
    "city": "ØµÙ†Ø¹Ø§Ø¡",
    "region": "Ø­ÙŠ Ø§Ù„Ø³Ø¨Ø¹ÙŠÙ†",
    "country": "Yemen",
    "postalCode": "12345",
    "coords": {
      "lat": 15.3694,
      "lng": 44.1910
    },
    "notes": "ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¹Ù†Ø¯ Ø§Ù„ÙˆØµÙˆÙ„",
    "isDefault": true,
    "isActive": true,
    "placeId": "ChIJd8BlQ2BZwokRAFUEcm_qrcA",
    "lastUsedAt": "2025-01-15T10:00:00.000Z",
    "usageCount": 15,
    "createdAt": "2025-01-01T00:00:00.000Z",
    "updatedAt": "2025-01-15T11:00:00.000Z"
  },
  "requestId": "req_addr_008"
}
```

### ÙƒÙˆØ¯ Flutter

```dart
Future<Address> setDefaultAddress(String id) async {
  final response = await _dio.post('/addresses/$id/set-default');

  final apiResponse = ApiResponse<Address>.fromJson(
    response.data,
    (json) => Address.fromJson((json as Map<String, dynamic>)['data']),
  );

  if (apiResponse.isSuccess) {
    return apiResponse.data!;
  } else {
    throw ApiException(apiResponse.error!);
  }
}
```

---

## 9. Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¹Ù†ÙˆØ§Ù† Ù…Ø­Ø°ÙˆÙ

ÙŠØ³ØªØ¹ÙŠØ¯ Ø¹Ù†ÙˆØ§Ù† Ù…Ø­Ø°ÙˆÙ (Ø­Ø°Ù Ù†Ø§Ø¹Ù…).

### Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨

- **Method:** `POST`
- **Endpoint:** `/addresses/:id/restore`
- **Auth Required:** âœ… Ù†Ø¹Ù…
- **Cache:** âŒ Ù„Ø§

### Response - Ù†Ø¬Ø§Ø­

```json
{
  "success": true,
  "message": "Address restored successfully",
  "data": {
    "_id": "64addr123",
    "userId": "64user456",
    "label": "Ø§Ù„Ù…Ù†Ø²Ù„",
    "addressType": "home",
    "recipientName": "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯",
    "recipientPhone": "773123456",
    "line1": "Ø´Ø§Ø±Ø¹ Ø§Ù„Ø³ØªÙŠÙ†ØŒ Ø¨Ø¬ÙˆØ§Ø± Ù…Ø·Ø¹Ù… Ø§Ù„Ø³Ù„Ø·Ø§Ù†",
    "line2": "Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø«Ø§Ù„Ø«ØŒ Ø´Ù‚Ø© 12",
    "city": "ØµÙ†Ø¹Ø§Ø¡",
    "region": "Ø­ÙŠ Ø§Ù„Ø³Ø¨Ø¹ÙŠÙ†",
    "country": "Yemen",
    "postalCode": "12345",
    "coords": {
      "lat": 15.3694,
      "lng": 44.1910
    },
    "notes": "ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¹Ù†Ø¯ Ø§Ù„ÙˆØµÙˆÙ„",
    "isDefault": false,
    "isActive": true,
    "placeId": "ChIJd8BlQ2BZwokRAFUEcm_qrcA",
    "lastUsedAt": "2025-01-15T10:00:00.000Z",
    "usageCount": 15,
    "createdAt": "2025-01-01T00:00:00.000Z",
    "updatedAt": "2025-01-15T11:00:00.000Z"
  },
  "requestId": "req_addr_009"
}
```

### ÙƒÙˆØ¯ Flutter

```dart
Future<Address> restoreAddress(String id) async {
  final response = await _dio.post('/addresses/$id/restore');

  final apiResponse = ApiResponse<Address>.fromJson(
    response.data,
    (json) => Address.fromJson((json as Map<String, dynamic>)['data']),
  );

  if (apiResponse.isSuccess) {
    return apiResponse.data!;
  } else {
    throw ApiException(apiResponse.error!);
  }
}
```

---

## 10. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ù„ÙƒÙŠØ©

ÙŠØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙŠØ®Øµ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….

### Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨

- **Method:** `GET`
- **Endpoint:** `/addresses/validate/:id`
- **Auth Required:** âœ… Ù†Ø¹Ù…
- **Cache:** âŒ Ù„Ø§

### Response - Ù†Ø¬Ø§Ø­

```json
{
  "success": true,
  "data": {
    "valid": true
  },
  "requestId": "req_addr_010"
}
```

### ÙƒÙˆØ¯ Flutter

```dart
Future<bool> validateAddressOwnership(String id) async {
  final response = await _dio.get('/addresses/validate/$id');

  final apiResponse = ApiResponse<Map<String, dynamic>>.fromJson(
    response.data,
    (json) => (json as Map<String, dynamic>)['data'],
  );

  if (apiResponse.isSuccess) {
    return apiResponse.data!['valid'] ?? false;
  } else {
    throw ApiException(apiResponse.error!);
  }
}
```

---

## Models ÙÙŠ Flutter

### Ù…Ù„Ù: `lib/models/address/address_models.dart`

```dart
enum AddressType {
  home,
  work,
  other,
}

class Address {
  final String id;
  final String userId;
  final String label;
  final AddressType addressType;
  final String recipientName;
  final String recipientPhone;
  final String line1;
  final String? line2;
  final String city;
  final String? region;
  final String country;
  final String? postalCode;
  final AddressCoords? coords;
  final String? notes;
  final bool isDefault;
  final bool isActive;
  final String? placeId;
  final DateTime? lastUsedAt;
  final int usageCount;
  final DateTime createdAt;
  final DateTime updatedAt;

  Address({
    required this.id,
    required this.userId,
    required this.label,
    required this.addressType,
    required this.recipientName,
    required this.recipientPhone,
    required this.line1,
    this.line2,
    required this.city,
    this.region,
    required this.country,
    this.postalCode,
    this.coords,
    this.notes,
    required this.isDefault,
    required this.isActive,
    this.placeId,
    this.lastUsedAt,
    required this.usageCount,
    required this.createdAt,
    required this.updatedAt,
  });

  factory Address.fromJson(Map<String, dynamic> json) {
    return Address(
      id: json['_id'],
      userId: json['userId'],
      label: json['label'] ?? '',
      addressType: AddressType.values.firstWhere(
        (e) => e.name == json['addressType'],
        orElse: () => AddressType.home,
      ),
      recipientName: json['recipientName'] ?? '',
      recipientPhone: json['recipientPhone'] ?? '',
      line1: json['line1'] ?? '',
      line2: json['line2'],
      city: json['city'] ?? '',
      region: json['region'],
      country: json['country'] ?? 'Yemen',
      postalCode: json['postalCode'],
      coords: json['coords'] != null 
          ? AddressCoords.fromJson(json['coords']) 
          : null,
      notes: json['notes'],
      isDefault: json['isDefault'] ?? false,
      isActive: json['isActive'] ?? true,
      placeId: json['placeId'],
      lastUsedAt: json['lastUsedAt'] != null 
          ? DateTime.parse(json['lastUsedAt']) 
          : null,
      usageCount: json['usageCount'] ?? 0,
      createdAt: DateTime.parse(json['createdAt']),
      updatedAt: DateTime.parse(json['updatedAt']),
    );
  }

  String get fullAddress {
    final parts = [
      line1,
      if (line2 != null) line2,
      city,
      if (region != null) region,
      country,
    ];
    return parts.join(', ');
  }

  String get shortAddress {
    final parts = [
      line1,
      city,
    ];
    return parts.join(', ');
  }

  bool get hasCoords => coords != null;
  bool get hasPlaceId => placeId != null && placeId!.isNotEmpty;
  bool get isRecentlyUsed => lastUsedAt != null && 
      DateTime.now().difference(lastUsedAt!).inDays < 7;
  bool get isFrequentlyUsed => usageCount > 10;
  bool get hasNotes => notes != null && notes!.isNotEmpty;
}

class AddressCoords {
  final double lat;
  final double lng;

  AddressCoords({
    required this.lat,
    required this.lng,
  });

  factory AddressCoords.fromJson(Map<String, dynamic> json) {
    return AddressCoords(
      lat: (json['lat'] ?? 0).toDouble(),
      lng: (json['lng'] ?? 0).toDouble(),
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'lat': lat,
      'lng': lng,
    };
  }

  bool get isValid => lat != 0 && lng != 0;
  String get displayString => '${lat.toStringAsFixed(6)}, ${lng.toStringAsFixed(6)}';
}
```

---

## ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©

1. **Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†:**
   - `home`: Ø§Ù„Ù…Ù†Ø²Ù„
   - `work`: Ø§Ù„Ù…ÙƒØªØ¨
   - `other`: Ø£Ø®Ø±Ù‰
   - Ø§Ø³ØªØ®Ø¯Ù… `AddressType` enum Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†ÙˆØ¹

2. **Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:**
   - `label`: ØªØ³Ù…ÙŠØ© Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (Ù…Ø«Ù„: "Ø§Ù„Ù…Ù†Ø²Ù„", "Ø§Ù„Ù…ÙƒØªØ¨")
   - `line1`: Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ø§Ù„Ø´Ø§Ø±Ø¹ØŒ Ø±Ù‚Ù… Ø§Ù„Ù…Ø¨Ù†Ù‰)
   - `line2`: ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ© (Ø±Ù‚Ù… Ø§Ù„Ø´Ù‚Ø©ØŒ Ø§Ù„Ø¯ÙˆØ±)
   - `city`: Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©
   - `region`: Ø§Ù„Ù…Ù†Ø·Ù‚Ø©/Ø§Ù„Ø­ÙŠ
   - `country`: Ø§Ù„Ø¯ÙˆÙ„Ø© (Ø§ÙØªØ±Ø§Ø¶ÙŠ: Yemen)

3. **Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª:**
   - `coords`: Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ© (lat, lng)
   - `placeId`: Google Place ID Ù„Ù„Ù…ÙˆÙ‚Ø¹
   - Ø§Ø³ØªØ®Ø¯Ù… `hasCoords` Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª
   - Ø§Ø³ØªØ®Ø¯Ù… `hasPlaceId` Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Place ID

4. **Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©:**
   - `recipientName`: Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…
   - `recipientPhone`: Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø§Ù„Ù…Ø³ØªÙ„Ù…
   - `notes`: Ù…Ù„Ø§Ø­Ø¸Ø§Øª/ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ØªØ³Ù„ÙŠÙ…

5. **Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:**
   - `usageCount`: Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
   - `lastUsedAt`: Ø¢Ø®Ø± Ù…Ø±Ø© Ø§Ø³ØªØ®Ø¯Ù… ÙÙŠÙ‡Ø§
   - `isRecentlyUsed`: Ø§Ø³ØªØ®Ø¯Ù… Ù…Ø¤Ø®Ø±Ø§Ù‹ (Ø£Ù‚Ù„ Ù…Ù† 7 Ø£ÙŠØ§Ù…)
   - `isFrequentlyUsed`: Ù…Ø³ØªØ®Ø¯Ù… Ø¨ÙƒØ«Ø±Ø© (Ø£ÙƒØ«Ø± Ù…Ù† 10 Ù…Ø±Ø§Øª)

6. **Ø§Ù„Ø­Ø§Ù„Ø©:**
   - `isDefault`: Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
   - `isActive`: Ù†Ø´Ø· Ø£Ù… Ù„Ø§
   - `hasNotes`: ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ù„Ø§Ø­Ø¸Ø§Øª

7. **Ø§Ù„Ø¹Ø±Ø¶ ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚:**
   - Ø§Ø³ØªØ®Ø¯Ù… `fullAddress` Ù„Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒØ§Ù…Ù„
   - Ø§Ø³ØªØ®Ø¯Ù… `shortAddress` Ù„Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø®ØªØµØ±
   - Ø§Ø¹Ø±Ø¶ `isRecentlyUsed` Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø¤Ø®Ø±Ø§Ù‹
   - Ø§Ø¹Ø±Ø¶ `isFrequentlyUsed` Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨ÙƒØ«Ø±Ø©
   - Ø§Ø¹Ø±Ø¶ `hasNotes` Ù„Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª

8. **Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ù„ÙƒÙŠØ©:**
   - Ø§Ø³ØªØ®Ø¯Ù… `validateAddressOwnership()` Ù‚Ø¨Ù„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
   - ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙŠØ®Øµ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…

9. **Ø§Ù„Ø­Ø°Ù ÙˆØ§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø©:**
   - Ø§Ù„Ø­Ø°Ù Ù†Ø§Ø¹Ù… (soft delete)
   - ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù…Ø­Ø°ÙˆÙØ©
   - Ø§Ø³ØªØ®Ø¯Ù… `includeDeleted: true` Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­Ø°ÙˆÙØ©

10. **Ø§Ù„Ø£Ø¯Ø§Ø¡:**
    - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ endpoints ØªØªØ·Ù„Ø¨ Ù…ØµØ§Ø¯Ù‚Ø©
    - Ù„Ø§ ÙŠÙˆØ¬Ø¯ cache Ù„Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† (Ø¨ÙŠØ§Ù†Ø§Øª Ø´Ø®ØµÙŠØ©)
    - Ø§Ø³ØªØ®Ø¯Ù… `getActiveAddresses()` Ù„Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù†Ø´Ø·Ø© ÙÙ‚Ø·

---

**Ø§Ù„ØªØ§Ù„ÙŠ:** [Ø®Ø¯Ù…Ø© Ø§Ù„Ø¨Ù†Ø±Ø§Øª (Banners)](./09-banners-service.md)

