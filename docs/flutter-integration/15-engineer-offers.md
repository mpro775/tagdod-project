# ğŸ’¼ Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ† (Engineer Offers)

> âœ… **ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚**: 100% Ù…ØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„ÙØ¹Ù„ÙŠ ÙÙŠ Backend  
> ğŸ“… **Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«**: ÙŠÙ†Ø§ÙŠØ± 2025

Ø®Ø¯Ù…Ø© Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ† ØªÙˆÙØ± endpoints Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø®Ø¯Ù…Ø§Øª.

> â„¹ï¸ **Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©**: Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø§Øª Ø§Ù„Ù†Ø§Ø¬Ø­Ø© ØªÙØºÙ„Ù‘Ù ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨ÙˆØ§Ø³Ø·Ø© `ResponseEnvelopeInterceptor` ÙˆØªØ¹ÙˆØ¯ Ø¨Ø§Ù„Ø´ÙƒÙ„ `{ success, data, requestId }`. Ù…Ø¹Ø¸Ù… Ø§Ù„Ù€ endpoints ØªÙØ±Ø¬Ø¹ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡Ø§ ØªØ­Øª Ø§Ù„Ù…ÙØªØ§Ø­ `data` Ø¯Ø§Ø®Ù„ Ø§Ù„Ø­Ù‚Ù„ `data` Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ø£ÙŠ `apiResponse.data['data']`). Ø±Ø§Ø¬Ø¹ `docs/flutter-integration/01-response-structure.md` Ù„Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„Ø©.

---

## ğŸ“‹ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª

### Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ (Customers)
1. [Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ø¹Ù„Ù‰ Ø·Ù„Ø¨](#1-Ø§Ù„Ø¹Ø±ÙˆØ¶-Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©-Ø¹Ù„Ù‰-Ø·Ù„Ø¨)
2. [ØªÙØ§ØµÙŠÙ„ Ø¹Ø±Ø¶ Ù…Ø­Ø¯Ø¯](#2-ØªÙØ§ØµÙŠÙ„-Ø¹Ø±Ø¶-Ù…Ø­Ø¯Ø¯)

### Ù„Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ† (Engineers)
3. [ØªÙ‚Ø¯ÙŠÙ… Ø¹Ø±Ø¶](#3-ØªÙ‚Ø¯ÙŠÙ…-Ø¹Ø±Ø¶)
4. [ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶](#4-ØªØ­Ø¯ÙŠØ«-Ø¹Ø±Ø¶)
5. [Ø­Ø°Ù Ø¹Ø±Ø¶](#5-Ø­Ø°Ù-Ø¹Ø±Ø¶)
6. [Ø¹Ø±ÙˆØ¶ÙŠ](#6-Ø¹Ø±ÙˆØ¶ÙŠ)

---

## Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ (Customers)

### 1. Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ø¹Ù„Ù‰ Ø·Ù„Ø¨

ÙŠØ³ØªØ±Ø¬Ø¹ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ù…Ø­Ø¯Ø¯.

**Method:** `GET`  
**Endpoint:** `/services/customer/:id/offers`  
**Auth Required:** âœ… Ù†Ø¹Ù…

#### Response - Ù†Ø¬Ø§Ø­

```json
{
  "success": true,
  "data": {
    "data": [
      {
        "_id": "64offer123",
        "requestId": "64service123",
        "engineerId": {
          "_id": "64engineer123",
          "firstName": "Ø£Ø­Ù…Ø¯",
          "lastName": "Ù…Ø­Ù…Ø¯",
          "phone": "777123456",
          "jobTitle": "Ù…Ù‡Ù†Ø¯Ø³ ÙƒÙ‡Ø±Ø¨Ø§Ø¡"
        },
        "amount": 750000,
        "note": "Ø³Ø£Ù‚ÙˆÙ… Ø¨ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø£Ø¹Ù„Ù‰ Ø¬ÙˆØ¯Ø©",
        "distanceKm": 2.5,
        "status": "OFFERED",
        "statusLabel": "Ø¹Ø±Ø¶ Ù…Ù‚Ø¯Ù…",
        "createdAt": "2025-01-15T14:00:00.000Z",
        "updatedAt": "2025-01-15T14:00:00.000Z"
      }
    ]
  }
}
```

#### ÙƒÙˆØ¯ Flutter

```dart
Future<List<EngineerOffer>> getOffersForRequest(String requestId) async {
  final response = await _dio.get('/services/customer/$requestId/offers');

  final apiResponse = ApiResponse<Map<String, dynamic>>.fromJson(
    response.data,
    (json) => json as Map<String, dynamic>,
  );

  if (apiResponse.isSuccess) {
    return (apiResponse.data!['data'] as List)
        .map((item) => EngineerOffer.fromJson(item))
        .toList();
  } else {
    throw ApiException(apiResponse.error!);
  }
}
```

---

### 2. ØªÙØ§ØµÙŠÙ„ Ø¹Ø±Ø¶ Ù…Ø­Ø¯Ø¯

ÙŠØ³ØªØ±Ø¬Ø¹ ØªÙØ§ØµÙŠÙ„ Ø¹Ø±Ø¶ Ù…Ø­Ø¯Ø¯ Ø¹Ù„Ù‰ Ø·Ù„Ø¨.

**Method:** `GET`  
**Endpoint:** `/services/customer/:requestId/offers/:offerId`  
**Auth Required:** âœ… Ù†Ø¹Ù…

#### Response - Ù†Ø¬Ø§Ø­

```json
{
  "success": true,
  "data": {
    "data": {
      "offer": {
        "_id": "64offer123",
        "amountYER": 9000,
        "note": "ÙŠØ´Ù…Ù„ Ø§Ù„ØªØ±ÙƒÙŠØ¨ Ø§Ù„ÙƒØ§Ù…Ù„",
        "status": "OFFERED",
        "statusLabel": "Ø¹Ø±Ø¶ Ù…Ù‚Ø¯Ù…",
        "createdAt": "2025-01-15T14:00:00.000Z",
        "engineer": {
          "id": "64engineer123",
          "name": "Ø­Ø³Ù† Ø§Ù„Ù„Ù‚Ù„ÙŠ",
          "jobTitle": "Ù…Ù‡Ù†Ø¯Ø³ ÙƒÙ‡Ø±Ø¨Ø§Ø¡",
          "phone": "777123456",
          "whatsapp": "https://wa.me/967777123456"
        }
      },
      "request": {
        "_id": "64service123",
        "title": "ØªØ±ÙƒÙŠØ¨ Ù…Ù†Ø¸ÙˆÙ…Ø© Ø´Ù…Ø³ÙŠØ©",
        "status": "OPEN",
        "statusLabel": "Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¹Ø±ÙˆØ¶"
      }
    }
  }
}
```

> âœ… Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„Ù€ endpoint Ù„Ø¨Ù†Ø§Ø¡ Ø´Ø§Ø´Ø© "Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³".

---

## Ù„Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ† (Engineers)

### 3. ØªÙ‚Ø¯ÙŠÙ… Ø¹Ø±Ø¶

ÙŠÙ‚Ø¯Ù… Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ Ø¹Ø±Ø¶ Ø¹Ù„Ù‰ Ø·Ù„Ø¨.

**Method:** `POST`  
**Endpoint:** `/services/engineer/offers`  
**Auth Required:** âœ… Ù†Ø¹Ù… (Engineer)

#### Request Body

```json
{
  "requestId": "64service123",
  "amount": 750000,
  "note": "Ø³Ø£Ù‚ÙˆÙ… Ø¨ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø£Ø¹Ù„Ù‰ Ø¬ÙˆØ¯Ø©",
  "lat": 44.2060,
  "lng": 15.3694
}
```

#### Response - Ù†Ø¬Ø§Ø­

```json
{
  "success": true,
  "data": {
    "data": {
      "_id": "64offer123",
      "requestId": "64service123",
      "engineerId": "64engineer123",
      "amount": 750000,
      "note": "Ø³Ø£Ù‚ÙˆÙ… Ø¨ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø£Ø¹Ù„Ù‰ Ø¬ÙˆØ¯Ø©",
      "distanceKm": 2.5,
      "status": "OFFERED",
      "createdAt": "2025-01-15T14:00:00.000Z",
      "updatedAt": "2025-01-15T14:00:00.000Z"
    }
  }
}
```

> â„¹ï¸ Ø¹Ù†Ø¯ ØªÙ‚Ø¯ÙŠÙ… Ø£ÙˆÙ„ Ø¹Ø±Ø¶ Ø¹Ù„Ù‰ Ø·Ù„Ø¨ØŒ ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† `OPEN` Ø¥Ù„Ù‰ `OFFERS_COLLECTING`.

#### ÙƒÙˆØ¯ Flutter

```dart
Future<EngineerOffer> createOffer({
  required String requestId,
  required double amount,
  String? note,
  required double lat,
  required double lng,
}) async {
  final response = await _dio.post('/services/engineer/offers', data: {
    'requestId': requestId,
    'amount': amount,
    if (note != null) 'note': note,
    'lat': lat,
    'lng': lng,
  });

  final apiResponse = ApiResponse<Map<String, dynamic>>.fromJson(
    response.data,
    (json) => json as Map<String, dynamic>,
  );

  if (apiResponse.isSuccess) {
    return EngineerOffer.fromJson(apiResponse.data!['data']);
  } else {
    throw ApiException(apiResponse.error!);
  }
}
```

---

### 4. ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶

ÙŠØ­Ø¯Ø« Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ Ø¹Ø±Ø¶Ù‡.

**Method:** `PATCH`  
**Endpoint:** `/services/engineer/offers/:id`  
**Auth Required:** âœ… Ù†Ø¹Ù… (Engineer)

#### Request Body

```json
{
  "amount": 700000,
  "note": "Ø³Ø£Ù‚ÙˆÙ… Ø¨ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø£Ø¹Ù„Ù‰ Ø¬ÙˆØ¯Ø© Ù…Ø¹ Ø®ØµÙ…"
}
```

#### Response - Ù†Ø¬Ø§Ø­

```json
{
  "success": true,
  "data": {
    "data": {
      "_id": "64offer123",
      "requestId": "64service123",
      "engineerId": "64engineer123",
      "amount": 700000,
      "note": "Ø³Ø£Ù‚ÙˆÙ… Ø¨ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø£Ø¹Ù„Ù‰ Ø¬ÙˆØ¯Ø© Ù…Ø¹ Ø®ØµÙ…",
      "distanceKm": 2.5,
      "status": "OFFERED",
      "createdAt": "2025-01-15T14:00:00.000Z",
      "updatedAt": "2025-01-15T15:00:00.000Z"
    }
  }
}
```

> âš ï¸ **Ù…Ù‡Ù…:** ÙŠÙ…ÙƒÙ† ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø­Ø§Ù„ØªÙ‡ `OFFERED`.

#### ÙƒÙˆØ¯ Flutter

```dart
Future<EngineerOffer> updateOffer({
  required String offerId,
  double? amount,
  String? note,
}) async {
  final response = await _dio.patch('/services/engineer/offers/$offerId', data: {
    if (amount != null) 'amount': amount,
    if (note != null) 'note': note,
  });

  final apiResponse = ApiResponse<Map<String, dynamic>>.fromJson(
    response.data,
    (json) => json as Map<String, dynamic>,
  );

  if (apiResponse.isSuccess) {
    return EngineerOffer.fromJson(apiResponse.data!['data']);
  } else {
    throw ApiException(apiResponse.error!);
  }
}
```

---

### 5. Ø­Ø°Ù Ø¹Ø±Ø¶

ÙŠØ­Ø°Ù Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ Ø¹Ø±Ø¶Ù‡.

**Method:** `DELETE`  
**Endpoint:** `/services/engineer/offers/:id`  
**Auth Required:** âœ… Ù†Ø¹Ù… (Engineer)

> âš ï¸ **Ù…Ù‡Ù…:** ÙŠØ³Ù…Ø­ Ø¨Ø­Ø°Ù Ø§Ù„Ø¹Ø±Ø¶ Ø·Ø§Ù„Ù…Ø§ Ø­Ø§Ù„ØªÙ‡ `OFFERED`.

#### Response - Ù†Ø¬Ø§Ø­

```json
{
  "success": true,
  "data": {
    "data": {
      "ok": true
    }
  }
}
```

#### ÙƒÙˆØ¯ Flutter

```dart
Future<bool> deleteOffer(String offerId) async {
  final response = await _dio.delete('/services/engineer/offers/$offerId');

  final apiResponse = ApiResponse<Map<String, dynamic>>.fromJson(
    response.data,
    (json) => json as Map<String, dynamic>,
  );

  if (apiResponse.isSuccess) {
    final result = apiResponse.data!['data'] as Map<String, dynamic>?;
    return result?['ok'] == true;
  } else {
    throw ApiException(apiResponse.error!);
  }
}
```

---

### 6. Ø¹Ø±ÙˆØ¶ÙŠ

ÙŠØ³ØªØ±Ø¬Ø¹ Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³.

**Method:** `GET`  
**Endpoint:** `/services/engineer/offers/my`  
**Auth Required:** âœ… Ù†Ø¹Ù… (Engineer)

#### Response - Ù†Ø¬Ø§Ø­

```json
{
  "success": true,
  "data": {
    "data": [
      {
        "_id": "64offer123",
        "requestId": {
          "_id": "64service123",
          "title": "ØªØ±ÙƒÙŠØ¨ Ù†Ø¸Ø§Ù… Ø·Ø§Ù‚Ø© Ø´Ù…Ø³ÙŠØ©",
          "status": "ASSIGNED"
        },
        "engineerId": "64engineer123",
        "amount": 750000,
        "note": "Ø³Ø£Ù‚ÙˆÙ… Ø¨ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø£Ø¹Ù„Ù‰ Ø¬ÙˆØ¯Ø©",
        "distanceKm": 2.5,
        "status": "ACCEPTED",
        "statusLabel": "Ø¹Ø±Ø¶ Ù…Ù‚Ø¨ÙˆÙ„",
        "createdAt": "2025-01-15T14:00:00.000Z",
        "updatedAt": "2025-01-15T14:00:00.000Z"
      }
    ]
  }
}
```

#### ÙƒÙˆØ¯ Flutter

```dart
Future<List<EngineerOffer>> getMyOffers() async {
  final response = await _dio.get('/services/engineer/offers/my');

  final apiResponse = ApiResponse<Map<String, dynamic>>.fromJson(
    response.data,
    (json) => json as Map<String, dynamic>,
  );

  if (apiResponse.isSuccess) {
    return (apiResponse.data!['data'] as List)
        .map((item) => EngineerOffer.fromJson(item))
        .toList();
  } else {
    throw ApiException(apiResponse.error!);
  }
}
```

---

## Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø¹Ø±Ø¶ (Status)

### Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©

| Ø§Ù„Ø­Ø§Ù„Ø© | Ø§Ù„ÙˆØµÙ | Ù…ØªÙ‰ ØªØ­Ø¯Ø« |
|--------|-------|----------|
| `OFFERED` | Ø¹Ø±Ø¶ Ù…Ù‚Ø¯Ù… | Ø¹Ù†Ø¯ ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø¹Ø±Ø¶ |
| `ACCEPTED` | Ø¹Ø±Ø¶ Ù…Ù‚Ø¨ÙˆÙ„ | Ø¹Ù†Ø¯ Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø¹Ø±Ø¶ Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ |
| `REJECTED` | Ø¹Ø±Ø¶ Ù…Ø±ÙÙˆØ¶ | Ø¹Ù†Ø¯ Ø±ÙØ¶ Ø§Ù„Ø¹Ø±Ø¶ Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø£Ùˆ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© |
| `CANCELLED` | Ø¹Ø±Ø¶ Ù…Ù„ØºÙ‰ | Ø¹Ù†Ø¯ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ø±Ø¶ Ù…Ù† Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ Ø£Ùˆ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© |
| `OUTBID` | ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø¹Ø±Ø¶ Ø¢Ø®Ø± | âœ… **Ø¬Ø¯ÙŠØ¯** - Ø¹Ù†Ø¯ Ù‚Ø¨ÙˆÙ„ Ø¹Ø±Ø¶ Ø¢Ø®Ø± Ø¹Ù„Ù‰ Ù†ÙØ³ Ø§Ù„Ø·Ù„Ø¨ |
| `EXPIRED` | Ø¹Ø±Ø¶ Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© | âœ… **Ø¬Ø¯ÙŠØ¯** - Ø¨Ø¹Ø¯ 5 Ø£ÙŠØ§Ù… Ø¨Ø¯ÙˆÙ† Ù‚Ø¨ÙˆÙ„ |

> âœ… **Ø­Ø§Ù„Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©:**
> - `OUTBID`: Ø¹Ù†Ø¯Ù…Ø§ ÙŠØªÙ… Ù‚Ø¨ÙˆÙ„ Ø¹Ø±Ø¶ Ø¢Ø®Ø± Ø¹Ù„Ù‰ Ù†ÙØ³ Ø§Ù„Ø·Ù„Ø¨
> - `EXPIRED`: Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙ†ØªÙ‡ÙŠ Ø§Ù„Ø¹Ø±Ø¶ Ø¨Ø¹Ø¯ 5 Ø£ÙŠØ§Ù… Ø¨Ø¯ÙˆÙ† Ù‚Ø¨ÙˆÙ„

### Ø§Ù„ØªØ¯ÙÙ‚

```
OFFERED â†’ ACCEPTED (Ø¹Ù†Ø¯ Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø¹Ø±Ø¶)
       â†“
    OUTBID (Ø¹Ù†Ø¯ Ù‚Ø¨ÙˆÙ„ Ø¹Ø±Ø¶ Ø¢Ø®Ø±)
       â†“
    EXPIRED (Ø¨Ø¹Ø¯ 5 Ø£ÙŠØ§Ù…)
       â†“
    REJECTED (Ø¹Ù†Ø¯ Ø§Ù„Ø±ÙØ¶)
       â†“
    CANCELLED (Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ù„ØºØ§Ø¡)
```

---

## Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©

> âš ï¸ **Ù…ÙŠØ²Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©:** ÙŠØªÙ… ÙØ­Øµ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…Ù†ØªÙ‡ÙŠØ© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© ÙŠÙˆÙ…ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ø³Ø§Ø¹Ø© 2 ØµØ¨Ø§Ø­Ø§Ù‹.

### Ø§Ù„Ø¹Ø±ÙˆØ¶

- Ø¥Ø°Ø§ ÙƒØ§Ù†Øª `OFFERED` ÙˆÙ„Ù… ÙŠØªÙ… Ù‚Ø¨ÙˆÙ„Ù‡Ø§ Ù„Ù…Ø¯Ø© **5 Ø£ÙŠØ§Ù…** â†’ `EXPIRED`
- ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ù…Ù‡Ù†Ø¯Ø³ Ø¹Ù†Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©

---

## Ù…Ø§ ÙŠØ­Ø¯Ø« Ø¹Ù†Ø¯ Ù‚Ø¨ÙˆÙ„ Ø¹Ø±Ø¶

Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙ‚Ø¨Ù„ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¹Ø±Ø¶Ø§Ù‹:

1. **Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„:**
   - ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„ØªÙ‡ Ø¥Ù„Ù‰ `ACCEPTED`
   - ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ `ASSIGNED`
   - ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ù…Ù‡Ù†Ø¯Ø³ ØµØ§Ø­Ø¨ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„

2. **Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø£Ø®Ø±Ù‰:**
   - ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„ØªÙ‡Ø§ Ø¥Ù„Ù‰ `OUTBID` (ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø¹Ø±Ø¶ Ø¢Ø®Ø±)
   - ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù„Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ† Ø§Ù„Ø°ÙŠÙ† ØªÙ… Ø±ÙØ¶ Ø¹Ø±ÙˆØ¶Ù‡Ù…
   - Ø§Ù„Ø±Ø³Ø§Ù„Ø©: "ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø¹Ø±Ø¶ Ø¢Ø®Ø± Ù„Ù„Ø·Ù„Ø¨. ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø¹Ø±Ø¶Ùƒ."

> âœ… **Ù…ÙŠØ²Ø© Ø¬Ø¯ÙŠØ¯Ø©:** Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…Ø±ÙÙˆØ¶Ø© Ø¨Ø³Ø¨Ø¨ Ù‚Ø¨ÙˆÙ„ Ø¹Ø±Ø¶ Ø¢Ø®Ø± ØªÙØ­Ø¯Ù‘Ø« Ø¥Ù„Ù‰ `OUTBID` Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† `REJECTED` Ù„ØªÙˆØ¶ÙŠØ­ Ø§Ù„Ø³Ø¨Ø¨.

---

## Models ÙÙŠ Flutter

### EngineerOfferStatus Enum

```dart
enum EngineerOfferStatus {
  OFFERED,
  ACCEPTED,
  REJECTED,
  CANCELLED,
  OUTBID,    // âœ… Ø¬Ø¯ÙŠØ¯
  EXPIRED,   // âœ… Ø¬Ø¯ÙŠØ¯
}
```

### EngineerOffer Model

```dart
class EngineerOffer {
  final String id;
  final dynamic requestId; // Ù‚Ø¯ ÙŠÙƒÙˆÙ† String Ø£Ùˆ Object (populated)
  final dynamic engineerId; // Ù‚Ø¯ ÙŠÙƒÙˆÙ† String Ø£Ùˆ Object (populated)
  final double amount;
  final String? note;
  final double? distanceKm;
  final EngineerOfferStatus status;
  final DateTime createdAt;
  final DateTime updatedAt;

  EngineerOffer({
    required this.id,
    required this.requestId,
    required this.engineerId,
    required this.amount,
    this.note,
    this.distanceKm,
    required this.status,
    required this.createdAt,
    required this.updatedAt,
  });

  factory EngineerOffer.fromJson(Map<String, dynamic> json) {
    return EngineerOffer(
      id: json['_id'] ?? '',
      requestId: json['requestId'],
      engineerId: json['engineerId'],
      amount: (json['amount'] ?? 0).toDouble(),
      note: json['note'],
      distanceKm: json['distanceKm']?.toDouble(),
      status: EngineerOfferStatus.values.firstWhere(
        (e) => e.name == json['status'],
        orElse: () => EngineerOfferStatus.OFFERED,
      ),
      createdAt: DateTime.parse(json['createdAt']),
      updatedAt: DateTime.parse(json['updatedAt']),
    );
  }

  // Helper methods
  bool get isOffered => status == EngineerOfferStatus.OFFERED;
  bool get isAccepted => status == EngineerOfferStatus.ACCEPTED;
  bool get isRejected => status == EngineerOfferStatus.REJECTED;
  bool get isCancelled => status == EngineerOfferStatus.CANCELLED;
  bool get isOutbid => status == EngineerOfferStatus.OUTBID; // âœ… Ø¬Ø¯ÙŠØ¯
  bool get isExpired => status == EngineerOfferStatus.EXPIRED; // âœ… Ø¬Ø¯ÙŠØ¯
  
  bool get hasNote => note != null && note!.isNotEmpty;
  bool get hasDistance => distanceKm != null;
  bool get isActive => isOffered || isAccepted;
  bool get isFinal => isAccepted || isRejected || isCancelled || isOutbid || isExpired; // âœ… Ù…Ø­Ø¯Ø«
  
  String get statusLabel {
    switch (status) {
      case EngineerOfferStatus.OFFERED:
        return 'Ø¹Ø±Ø¶ Ù…Ù‚Ø¯Ù…';
      case EngineerOfferStatus.ACCEPTED:
        return 'Ø¹Ø±Ø¶ Ù…Ù‚Ø¨ÙˆÙ„';
      case EngineerOfferStatus.REJECTED:
        return 'Ø¹Ø±Ø¶ Ù…Ø±ÙÙˆØ¶';
      case EngineerOfferStatus.CANCELLED:
        return 'Ø¹Ø±Ø¶ Ù…Ù„ØºÙ‰';
      case EngineerOfferStatus.OUTBID:
        return 'ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø¹Ø±Ø¶ Ø¢Ø®Ø±'; // âœ… Ø¬Ø¯ÙŠØ¯
      case EngineerOfferStatus.EXPIRED:
        return 'Ø¹Ø±Ø¶ Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©'; // âœ… Ø¬Ø¯ÙŠØ¯
    }
  }
  
  String get formattedAmount => '${amount.toStringAsFixed(0)} Ø±ÙŠØ§Ù„';
  String get formattedDistance => hasDistance ? '${distanceKm!.toStringAsFixed(1)} ÙƒÙ…' : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
}
```

### CreateOfferDto

```dart
class CreateOfferDto {
  final String requestId;
  final double amount;
  final String? note;
  final double lat;
  final double lng;

  CreateOfferDto({
    required this.requestId,
    required this.amount,
    this.note,
    required this.lat,
    required this.lng,
  });

  Map<String, dynamic> toJson() {
    return {
      'requestId': requestId,
      'amount': amount,
      if (note != null) 'note': note,
      'lat': lat,
      'lng': lng,
    };
  }
}
```

### UpdateOfferDto

```dart
class UpdateOfferDto {
  final double? amount;
  final String? note;

  UpdateOfferDto({
    this.amount,
    this.note,
  });

  Map<String, dynamic> toJson() {
    return {
      if (amount != null) 'amount': amount,
      if (note != null) 'note': note,
    };
  }
}
```

---

## Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©

1. **ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø¹Ø±ÙˆØ¶:**
   - Ø¹Ù†Ø¯ ØªÙ‚Ø¯ÙŠÙ… Ø£ÙˆÙ„ Ø¹Ø±Ø¶ØŒ ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† `OPEN` Ø¥Ù„Ù‰ `OFFERS_COLLECTING`
   - ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³

2. **Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø¹Ø±Ø¶:**
   - Ø¹Ù†Ø¯ Ù‚Ø¨ÙˆÙ„ Ø¹Ø±Ø¶ØŒ ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø£Ø®Ø±Ù‰ Ø¥Ù„Ù‰ `OUTBID`
   - ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù„Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ†

3. **Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©:**
   - Ø§Ù„Ø¹Ø±ÙˆØ¶ `OFFERED` Ù„Ù…Ø¯Ø© 5 Ø£ÙŠØ§Ù… â†’ `EXPIRED`
   - ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹

4. **ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶:**
   - ÙŠÙ…ÙƒÙ† ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø­Ø§Ù„ØªÙ‡ `OFFERED`
   - ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø§Ù„Ø¹Ø±Ø¶ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø­Ø§Ù„ØªÙ‡ `OFFERED`

---

## Ù…Ù„ÙØ§Øª Backend Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠØ©

- `backend/src/modules/services/customer.controller.ts` - customer endpoints Ù„Ù„Ø¹Ø±ÙˆØ¶
- `backend/src/modules/services/engineer.controller.ts` - engineer endpoints Ù„Ù„Ø¹Ø±ÙˆØ¶
- `backend/src/modules/services/schemas/engineer-offer.schema.ts` - EngineerOffer Schema
- `backend/src/modules/services/services.service.ts` - Services Service
- `backend/src/modules/services/enums/service-status.enum.ts` - OfferStatus Enum

