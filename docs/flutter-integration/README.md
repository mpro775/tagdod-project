# ๐ฑ ุฏููู ุงูุฑุจุท ูุน ุชุทุจูู Flutter

ูุฑุญุจุงู ุจู ูู ุฏููู ุงูุฑุจุท ุงูุดุงูู ููุชุทุจูู. ูุฐุง ุงูุฏููู ูุญุชูู ุนูู ุฌููุน ุงููุนูููุงุช ุงูุชู ุชุญุชุงุฌูุง ููุชูุงูู ูุน ุงูู Backend API.

---

## ๐ ุฌุฏูู ุงููุญุชููุงุช

### ุงูุฃุณุงุณูุงุช
1. [**ูููู ุงูุงุณุชุฌุงุจุฉ ุงูููุญุฏุฉ ูุงูุฃุฎุทุงุก**](./01-response-structure.md) - **ุงุจุฏุฃ ูู ููุง**
   - ุดูู ุงูุงุณุชุฌุงุจุฉ ุงููุงุฌุญุฉ
   - ุดูู ุงูุงุณุชุฌุงุจุฉ ุนูุฏ ุญุฏูุซ ุฎุทุฃ
   - ุฃููุงุฏ ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ
   - ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูู Flutter

### ุงูุฎุฏูุงุช ุงูุฑุฆูุณูุฉ
2. [**ุฎุฏูุฉ ุงููุตุงุฏูุฉ (Authentication)**](./02-auth-service.md)
   - ุชุณุฌูู ุงูุฏุฎูู ุจูุงุณุทุฉ OTP
   - ุฅุฏุงุฑุฉ ุงูุญุณุงุจ
   - ุงูุชูููุงุช (Access & Refresh)

3. [**ุฎุฏูุฉ ุงูููุชุฌุงุช (Products)**](./03-products-service.md)
   - ูุงุฆูุฉ ุงูููุชุฌุงุช
   - ุชูุงุตูู ุงูููุชุฌ
   - ุงูููุชุฌุงุช ุงููููุฒุฉ ูุงูุฌุฏูุฏุฉ
   - ุงูููุงุชุฑ ูุงูุชุฑุชูุจ

4. [**ุฎุฏูุฉ ุงูุณูุฉ (Cart)**](./04-cart-service.md)
   - ุฅุถุงูุฉ ููุชุฌุงุช ููุณูุฉ
   - ุชุญุฏูุซ ุงููููุงุช
   - ุญุณุงุจ ุงูุฅุฌูุงูู
   - ุฏูุฌ ุณูุฉ ุงูุฒุงุฆุฑ ูุน ุงููุณุชุฎุฏู

5. [**ุฎุฏูุฉ ุงูุฏูุน ูุงูุทูุจุงุช (Checkout & Orders)**](./05-checkout-service.md)
   - ูุนุงููุฉ ุงูุทูุจ
   - ุชุฃููุฏ ุงูุทูุจ
   - ุฅุฏุงุฑุฉ ุงูุทูุจุงุช
   - ุญุงูุงุช ุงูุทูุจ

6. [**ุฎุฏูุฉ ุงูุชุตูููุงุช (Categories)**](./06-categories-service.md)
   - ูุงุฆูุฉ ุงูุชุตูููุงุช
   - ุดุฌุฑุฉ ุงูุชุตูููุงุช
   - ุงูุชุตูููุงุช ุงููููุฒุฉ

7. [**ุฎุฏูุฉ ุงูููุถูุงุช (Favorites)**](./07-favorites-service.md)
   - ุฅุถุงูุฉ ูุญุฐู ุงูููุถูุงุช
   - ูุงุฆูุฉ ุงูููุถูุงุช
   - ูุฒุงููุฉ ุงูููุถูุงุช

8. [**ุฎุฏูุฉ ุงูุนูุงููู (Addresses)**](./08-addresses-service.md)
   - ุฅุฏุงุฑุฉ ุนูุงููู ุงูุชูุตูู
   - ุชุนููู ุงูุนููุงู ุงูุงูุชุฑุงุถู
   - ุงูุชุญูู ูู ุตุญุฉ ุงูุนูุงููู

### ุงูุฎุฏูุงุช ุงููุณุงุนุฏุฉ
9. [**ุฎุฏูุฉ ุงูุจูุฑุงุช (Banners)**](./09-banners-service.md)
   - ุนุฑุถ ุงูุจูุฑุงุช
   - ุชุชุจุน ุงููุดุงูุฏุงุช ูุงูููุฑุงุช

10. [**ุฎุฏูุฉ ุงูุนูุงูุงุช ุงูุชุฌุงุฑูุฉ (Brands)**](./10-brands-service.md)
    - ูุงุฆูุฉ ุงูุจุฑุงูุฏุงุช
    - ุชูุงุตูู ุงูุจุฑุงูุฏ

11. [**ุฎุฏูุฉ ุงูุจุญุซ (Search)**](./11-search-service.md)
    - ุงูุจุญุซ ุงูุดุงูู
    - ุงูุจุญุซ ุงููุชูุฏู
    - ุงูุงูุชุฑุงุญุงุช ุงูุชููุงุฆูุฉ

12. [**ุฎุฏูุฉ ุงูููุจููุงุช (Coupons)**](./12-coupons-service.md)
    - ุงูุชุญูู ูู ุงูููุจููุงุช
    - ุชุทุจูู ุงูุฎุตููุงุช

13. [**ุฎุฏูุฉ ุงูุชุณุนูุฑ (Pricing)**](./13-pricing-service.md)
    - ุญุณุงุจ ุงูุฃุณุนุงุฑ
    - ุงูุนุฑูุถ ูุงูุฎุตููุงุช

14. [**ุฎุฏูุฉ ุงูุฅุดุนุงุฑุงุช (Notifications)**](./14-notifications-service.md)
    - ูุงุฆูุฉ ุงูุฅุดุนุงุฑุงุช
    - ุชุณุฌูู ุงูุฃุฌูุฒุฉ ููุฅุดุนุงุฑุงุช

15. [**ุฎุฏูุฉ ุงูุทูุจุงุช ุงูููุฏุณูุฉ (Services)**](./15-services-service.md)
    - ุฅูุดุงุก ุทูุจ ุฎุฏูุฉ
    - ูุจูู ุงูุนุฑูุถ
    - ุงูุชูููู

16. [**ุฎุฏูุฉ ุงูุณูุงุช (Attributes)**](./16-attributes-service.md)
    - ูุงุฆูุฉ ุงูุณูุงุช ุงููุดุทุฉ
    - ุงูุณูุงุช ุงููุงุจูุฉ ููููุชุฑุฉ
    - ุชูุงุตูู ุงูุณูุฉ

17. [**ุฎุฏูุฉ ุงูุฏุนู (Support)**](./17-support-service.md)
    - ุฅูุดุงุก ุชุฐูุฑุฉ ุฏุนู
    - ุฅุฏุงุฑุฉ ุงูุฑุณุงุฆู
    - ุชุชุจุน ุญุงูุฉ ุงูุชุฐูุฑุฉ

---

## ๐ ูุนูููุงุช ุนุงูุฉ

### Base URL
```
http://localhost:3000
```
> **ููุงุญุธุฉ:** ุงุณุชุจุฏู ูุฐุง ุงูุฑุงุจุท ุจุงูุฑุงุจุท ุงููุนูู ููู Production ุนูุฏ ุงููุดุฑ

### ุงูููุฏุฑุงุช (Headers) ุงููุทููุจุฉ

#### ููุทูุจุงุช ุงูุนุงูุฉ (Public):
```dart
{
  'Content-Type': 'application/json',
}
```

#### ููุทูุจุงุช ุงููุญููุฉ (Protected):
```dart
{
  'Content-Type': 'application/json',
  'Authorization': 'Bearer {access_token}',
}
```

---

## ๐ ุงููุตุงุฏูุฉ (Authentication)

API ูุณุชุฎุฏู **JWT (JSON Web Tokens)** ูููุตุงุฏูุฉ:
- **Access Token**: ุตุงูุญ ููุฏุฉ ูุตูุฑุฉ (15 ุฏูููุฉ)
- **Refresh Token**: ุตุงูุญ ููุฏุฉ ุทูููุฉ (7 ุฃูุงู)

ุนูุฏ ุงูุชูุงุก ุตูุงุญูุฉ Access Tokenุ ุงุณุชุฎุฏู Refresh Token ููุญุตูู ุนูู ุชููู ุฌุฏูุฏ.

---

## ๐ฆ ูููู ุงูุงุณุชุฌุงุจุฉ ุงูููุญุฏุฉ

### ุงูุงุณุชุฌุงุจุฉ ุงููุงุฌุญุฉ
```json
{
  "success": true,
  "data": { /* ุงูุจูุงูุงุช */ },
  "meta": { /* ูุนูููุงุช ุฅุถุงููุฉ ูุซู pagination */ },
  "requestId": "uuid-string"
}
```

### ุงูุงุณุชุฌุงุจุฉ ุนูุฏ ุงูุฎุทุฃ
```json
{
  "success": false,
  "error": {
    "code": "ERROR_CODE",
    "message": "ุฑุณุงูุฉ ุงูุฎุทุฃ ุจุงูุนุฑุจูุฉ",
    "details": null,
    "fieldErrors": [
      {
        "field": "phone",
        "message": "ุฑูู ุงููุงุชู ุบูุฑ ุตุญูุญ"
      }
    ]
  },
  "requestId": "uuid-string"
}
```

> **ูููุฒูุฏ ูู ุงูุชูุงุตููุ ุฑุงุฌุน:** [ูููู ุงูุงุณุชุฌุงุจุฉ ุงูููุญุฏุฉ](./01-response-structure.md)

---

## ๐ ุงูุจุฏุก ุงูุณุฑูุน

### 1. ูู ุจุฅูุดุงุก HTTP Client ูู Flutter:

```dart
import 'package:dio/dio.dart';

class ApiClient {
  final Dio _dio;
  final String baseUrl = 'http://localhost:3000';
  
  ApiClient() : _dio = Dio() {
    _dio.options.baseUrl = baseUrl;
    _dio.options.connectTimeout = const Duration(seconds: 30);
    _dio.options.receiveTimeout = const Duration(seconds: 30);
    
    // ุฅุถุงูุฉ Interceptor ููุชููู
    _dio.interceptors.add(
      InterceptorsWrapper(
        onRequest: (options, handler) async {
          final token = await getAccessToken(); // ูู SharedPreferences
          if (token != null) {
            options.headers['Authorization'] = 'Bearer $token';
          }
          return handler.next(options);
        },
        onError: (error, handler) async {
          // ูุนุงูุฌุฉ ุงูุชูุงุก ุตูุงุญูุฉ ุงูุชููู
          if (error.response?.statusCode == 401) {
            // ูู ุจุชุญุฏูุซ ุงูุชููู
            final newToken = await refreshToken();
            if (newToken != null) {
              // ุฃุนุฏ ุงููุญุงููุฉ
              error.requestOptions.headers['Authorization'] = 'Bearer $newToken';
              return handler.resolve(await _dio.fetch(error.requestOptions));
            }
          }
          return handler.next(error);
        },
      ),
    );
  }
  
  Dio get dio => _dio;
}
```

### 2. ูู ุจุฅูุดุงุก Models ููุงุณุชุฌุงุจุฉ:

```dart
class ApiResponse<T> {
  final bool success;
  final T? data;
  final ApiError? error;
  final Map<String, dynamic>? meta;
  final String? requestId;
  
  ApiResponse({
    required this.success,
    this.data,
    this.error,
    this.meta,
    this.requestId,
  });
  
  factory ApiResponse.fromJson(
    Map<String, dynamic> json,
    T Function(dynamic)? fromJsonT,
  ) {
    return ApiResponse(
      success: json['success'] ?? false,
      data: json['data'] != null && fromJsonT != null 
          ? fromJsonT(json['data']) 
          : json['data'],
      error: json['error'] != null 
          ? ApiError.fromJson(json['error']) 
          : null,
      meta: json['meta'],
      requestId: json['requestId'],
    );
  }
}

class ApiError {
  final String code;
  final String message;
  final dynamic details;
  final List<FieldError>? fieldErrors;
  
  ApiError({
    required this.code,
    required this.message,
    this.details,
    this.fieldErrors,
  });
  
  factory ApiError.fromJson(Map<String, dynamic> json) {
    return ApiError(
      code: json['code'] ?? 'UNKNOWN_ERROR',
      message: json['message'] ?? 'ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุน',
      details: json['details'],
      fieldErrors: json['fieldErrors'] != null
          ? (json['fieldErrors'] as List)
              .map((e) => FieldError.fromJson(e))
              .toList()
          : null,
    );
  }
}

class FieldError {
  final String field;
  final String message;
  
  FieldError({required this.field, required this.message});
  
  factory FieldError.fromJson(Map<String, dynamic> json) {
    return FieldError(
      field: json['field'] ?? '',
      message: json['message'] ?? '',
    );
  }
}
```

### 3. ุงุณุชุฎุฏุงู API:

```dart
final apiClient = ApiClient();

// ูุซุงู: ุชุณุฌูู ุฏุฎูู
Future<void> login() async {
  try {
    final response = await apiClient.dio.post(
      '/auth/send-otp',
      data: {
        'phone': '777123456',
        'context': 'register',
      },
    );
    
    final apiResponse = ApiResponse.fromJson(
      response.data,
      (data) => data,
    );
    
    if (apiResponse.success) {
      print('ุชู ุฅุฑุณุงู ุงูููุฏ: ${apiResponse.data}');
    } else {
      print('ุฎุทุฃ: ${apiResponse.error?.message}');
    }
  } on DioException catch (e) {
    print('ุฎุทุฃ ูู ุงูุงุชุตุงู: ${e.message}');
  }
}
```

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ุงุจุฏุฃ ุจูุฑุงุกุฉ** [ูููู ุงูุงุณุชุฌุงุจุฉ ุงูููุญุฏุฉ](./01-response-structure.md)
2. **ูู ุจุฅุนุฏุงุฏ** [ุฎุฏูุฉ ุงููุตุงุฏูุฉ](./02-auth-service.md)
3. **ุชุตูุญ** ุจููุฉ ุงูุฎุฏูุงุช ุญุณุจ ุงุญุชูุงุฌู

---

## ๐ก ูุตุงุฆุญ ูููุฉ

### โ ุฃูุถู ุงูููุงุฑุณุงุช

1. **ุงุญูุธ ุงูุชููู ุจุดูู ุขูู** ูู `SharedPreferences` ุฃู `FlutterSecureStorage`
2. **ุงุณุชุฎุฏู Interceptors** ููุชุนุงูู ูุน ุงูุชูููุงุช ุชููุงุฆูุงู
3. **ุชุนุงูู ูุน ุงูุฃุฎุทุงุก** ุจุดูู ููุงุณุจ ูุฃุธูุฑ ุฑุณุงุฆู ูุงุถุญุฉ ูููุณุชุฎุฏู
4. **ุงุณุชุฎุฏู Models** ููู ุงุณุชุฌุงุจุฉ ุจุฏูุงู ูู ุงูุชุนุงูู ูุน JSON ูุจุงุดุฑุฉ
5. **ูุนูู Caching** ููุทูุจุงุช ุงูุชู ูุง ุชุชุบูุฑ ูุซูุฑุงู (ูุซู Categories ู Brands)

### โ๏ธ ุชุญุฐูุฑุงุช

1. **ูุง ุชุฎุฒู** ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ (ูุซู ูููุงุช ุงููุฑูุฑ) ุนูู ุงูุฌูุงุฒ
2. **ุงุณุชุฎุฏู HTTPS** ูู ุงูู Production
3. **ุชุญูู ุฏุงุฆูุงู** ูู `success` ูู ุงูุงุณุชุฌุงุจุฉ ูุจู ุงุณุชุฎุฏุงู ุงูุจูุงูุงุช
4. **ุชุนุงูู ูุน** ุญุงูุงุช ุงููุทุงุน ุงูุฅูุชุฑูุช

---

## ๐ ุงูุฏุนู

ูู ุญุงูุฉ ูุฌูุฏ ุฃู ุงุณุชูุณุงุฑุงุช ุฃู ูุดุงูู:
1. ุฑุงุฌุน ุงูููู ุงูููุงุณุจ ููุฎุฏูุฉ
2. ุชุญูู ูู ุฃููุงุฏ ุงูุฃุฎุทุงุก ูู [ูููู ุงูุงุณุชุฌุงุจุฉ](./01-response-structure.md)
3. ุชูุงุตู ูุน ูุฑูู ุงูู Backend

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2025-01-15
**ุงููุณุฎุฉ:** 1.1.0

