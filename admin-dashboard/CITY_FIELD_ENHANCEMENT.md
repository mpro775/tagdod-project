# ๐๏ธ ุชุญุณูู ุญูู ุงููุฏููุฉ - City Field Enhancement

## โ ุงูุชุญุณูู ุงูููุทุจู

### ูุจู ุงูุชุญุณูู:
- โ ุญูู ุงููุฏููุฉ ูุธูุฑ **ููุท ูููููุฏุณูู**
- โ ุบูุฑ ูุชุงุญ ูููุณุชุฎุฏููู ุงูุนุงุฏููู ูุงูุชุฌุงุฑ

### ุจุนุฏ ุงูุชุญุณูู:
- โ ุญูู ุงููุฏููุฉ ูุธูุฑ **ูุฌููุน ุงููุณุชุฎุฏููู**:
  - ๐ต **ูุณุชุฎุฏู** (User) โ ุงููุฏููุฉ ูุชุงุญุฉ
  - ๐ก **ูููุฏุณ** (Engineer) โ ุงููุฏููุฉ ูุชุงุญุฉ
  - ๐ข **ุชุงุฌุฑ** (Merchant) โ ุงููุฏููุฉ ูุชุงุญุฉ
  - ๐ด **ุฃุฏูู** (Admin) โ ุงููุฏููุฉ ุบูุฑ ูุทููุจุฉ
  - โซ **ุณูุจุฑ ุฃุฏูู** (Super Admin) โ ุงููุฏููุฉ ุบูุฑ ูุทููุจุฉ

---

## ๐ ูุงุฆูุฉ ุงููุฏู ุงูููููุฉ ุงููุฏุนููุฉ

ุชู ุฅุถุงูุฉ **22 ูุฏููุฉ ููููุฉ**:

1. ุตูุนุงุก (ุงูุงูุชุฑุงุถูุฉ) โญ
2. ุนุฏู
3. ุชุนุฒ
4. ุงูุญุฏูุฏุฉ
5. ุฅุจ
6. ุฐูุงุฑ
7. ุงููููุง
8. ุญุฌุฉ
9. ุนูุฑุงู
10. ุตุนุฏุฉ
11. ุณูุฆูู
12. ุฒูุฌุจุงุฑ
13. ูุฃุฑุจ
14. ุงูุจูุถุงุก
15. ูุญุฌ
16. ุฃุจูู
17. ุดุจูุฉ
18. ุงููุญููุช
19. ุญุถุฑููุช
20. ุงูุฌูู
21. ุงูููุฑุฉ
22. ุณูุทุฑู

---

## ๐ฏ ูููุน ุงูุญูู ูู ุงููููุฐุฌ

### ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ุฑูู ุงููุงุชู *        โ ุงูุงุณู ุงูุฃูู      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ุงูุงุณู ุงูุฃุฎูุฑ        โ ุงูุฌูุณ           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ุงููุฏููุฉ โญ          โ ูููุฉ ุงููุฑูุฑ      โ
โ (ููุฌููุน ุนุฏุง ุงูุฃุฏูู) โ                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ูุนูููุงุช ุงููููุฏุณ (ุฅุถุงููุฉ):
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ุงููุณูู ุงููุธููู / ุงูุชุฎุตุต               โ
โ (ูููุฏุณ ููุฑุจุงุฆูุ ุทุงูุฉ ุดูุณูุฉ...)        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ง ุงูุชุบููุฑุงุช ุงูุชูููุฉ

### Backend:

#### 1. DTOs ูุญุฏุซุฉ:
```typescript
// create-user-admin.dto.ts
export class CreateUserAdminDto {
  phone!: string;
  firstName?: string;
  lastName?: string;
  gender?: 'male' | 'female' | 'other';
  jobTitle?: string;
  city?: string;  // โ ูุถุงู
  // ...
}

// update-user-admin.dto.ts
export class UpdateUserAdminDto {
  firstName?: string;
  lastName?: string;
  gender?: 'male' | 'female' | 'other';
  jobTitle?: string;
  city?: string;  // โ ูุถุงู
  // ...
}
```

#### 2. Controller ูุญุฏุซ:
```typescript
// ูู createUser
const userData = {
  phone: dto.phone,
  firstName: dto.firstName,
  lastName: dto.lastName,
  gender: dto.gender,
  jobTitle: dto.jobTitle,
  city: dto.city || 'ุตูุนุงุก',  // โ ูุถุงู
  // ...
};

// ูู updateUser
if (dto.city !== undefined) user.city = dto.city;  // โ ูุถุงู
```

### Frontend:

#### 1. Types ูุญุฏุซุฉ:
```typescript
// user.types.ts
export interface User {
  phone: string;
  firstName?: string;
  lastName?: string;
  gender?: 'male' | 'female' | 'other';
  jobTitle?: string;
  city?: string;  // โ ูุถุงู
  // ...
}

export interface CreateUserDto {
  // ...
  jobTitle?: string;
  city?: string;  // โ ูุถุงู
  // ...
}
```

#### 2. Constants ุฌุฏูุฏุฉ:
```typescript
// yemen-cities.ts โ ููู ุฌุฏูุฏ
export const YEMEN_CITIES = [
  { value: 'ุตูุนุงุก', label: 'ุตูุนุงุก' },
  { value: 'ุนุฏู', label: 'ุนุฏู' },
  // ... 22 ูุฏููุฉ
];

export const DEFAULT_CITY = 'ุตูุนุงุก';
```

#### 3. Form Schema ูุญุฏุซ:
```typescript
const userSchema = z.object({
  // ...
  jobTitle: z.string().optional(),
  city: z.string().optional(),  // โ ูุถุงู
  // ...
});
```

#### 4. Component ูุญุฏุซ:
```tsx
{/* ุงููุฏููุฉ - ูุฌููุน ุงููุณุชุฎุฏููู ุนุฏุง ุงูุฃุฏูู */}
{!isAdminRole() && (
  <Grid size={{ xs: 12, sm: 6 }}>
    <FormSelect
      name="city"
      label="ุงููุฏููุฉ"
      options={YEMEN_CITIES}
      helperText={
        primaryRole === UserRole.ENGINEER 
          ? "ุงููุฏููุฉ ุงูุชู ูุนูู ูููุง ุงููููุฏุณ" 
          : "ูุฏููุฉ ุงููุณุชุฎุฏู"
      }
    />
  </Grid>
)}
```

---

## ๐ก ููุงุฆุฏ ุงูุชุญุณูู

### 1. **ูููุณุชุฎุฏููู ุงูุนุงุฏููู**:
- ูููู ุชุญุฏูุฏ ูุฏููุชูู ูุชุญุณูู ุชุฌุฑุจุฉ ุงูุดุญู ูุงูุชูุตูู
- ูููุฏ ูุนุฑุถ ุนุฑูุถ ุฎุงุตุฉ ุจุงููุฏููุฉ

### 2. **ูููููุฏุณูู**:
- **ุถุฑูุฑู** ูุชุญุฏูุฏ ููุทูุฉ ุนูููู
- ููุณุชุฎุฏู ูู ูุทุงุจูุฉ ุทูุจุงุช ุงูุฎุฏูุฉ ุจุงููููุฏุณูู ุงููุฑูุจูู
- ูุธูุฑ ููุนููุงุก ุนูุฏ ุงุฎุชูุงุฑ ุงููููุฏุณ

### 3. **ููุชุฌุงุฑ**:
- ุชุญุฏูุฏ ูุฏููุฉ ุงููุชุฌุฑ/ุงููุฎุฒู
- ูููุฏ ููุชุญูููุงุช ุงูุฌุบุฑุงููุฉ

### 4. **ููุฃุฏูู**:
- ุบูุฑ ูุทููุจ ูุฃู ุงูุฃุฏูู ูุนูู ุนูู ูุณุชูู ุงููุธุงู ุจุฃูููู

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ุฅูุดุงุก ูุณุชุฎุฏู ุฌุฏูุฏ:
1. ุงุฐูุจ ุฅูู `/users/new`
2. ุงููุฃ ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ
3. ุงุฎุชุฑ ุงูุฏูุฑ (User/Engineer/Merchant)
4. **ุงุฎุชุฑ ุงููุฏููุฉ** ูู ุงููุงุฆูุฉ ุงูููุณุฏูุฉ โ
5. ูููููุฏุณ: ุฃุถู ุฃูุถุงู ุงููุณูู ุงููุธููู
6. ููุชุงุฌุฑ: ุฃุถู ุฃูุถุงู ูุณุจุฉ ุงูุชุฎููุถ
7. ุงุญูุธ

---

## ๐ ุงูุจูุงูุงุช

### ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:
```javascript
// ูุซุงู: ูููุฏุณ
{
  "_id": "...",
  "phone": "+967777123456",
  "firstName": "ุฃุญูุฏ",
  "lastName": "ูุญูุฏ",
  "jobTitle": "ูููุฏุณ ููุฑุจุงุฆู",
  "city": "ุตูุนุงุก",  // โ
  "roles": ["engineer"],
  "engineer_capable": true,
  "engineer_status": "approved"
}

// ูุซุงู: ุชุงุฌุฑ
{
  "_id": "...",
  "phone": "+967777654321",
  "firstName": "ูุงุทูุฉ",
  "city": "ุนุฏู",  // โ
  "roles": ["merchant"],
  "wholesale_capable": true,
  "wholesale_discount_percent": 15
}

// ูุซุงู: ูุณุชุฎุฏู ุนุงุฏู
{
  "_id": "...",
  "phone": "+967777111222",
  "firstName": "ุนูู",
  "city": "ุชุนุฒ",  // โ
  "roles": ["user"],
  "customer_capable": true
}
```

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

### Backend:
- โ `backend/src/modules/users/admin/dto/create-user-admin.dto.ts`
- โ `backend/src/modules/users/admin/dto/update-user-admin.dto.ts`
- โ `backend/src/modules/users/admin/users.admin.controller.ts`

### Frontend:
- โ ุฌุฏูุฏ: `admin-dashboard/src/shared/constants/yemen-cities.ts`
- โ `admin-dashboard/src/features/users/types/user.types.ts`
- โ `admin-dashboard/src/features/users/pages/UserFormPage.tsx`

---

## โ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

**ุญูู ุงููุฏููุฉ ุงูุขู:**
- โ ูุชุงุญ ูุฌููุน ุงููุณุชุฎุฏููู (ุนุฏุง ุงูุฃุฏูู)
- โ ูู ูุณู ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ
- โ ูุงุฆูุฉ ููุณุฏูุฉ ุจ 22 ูุฏููุฉ ููููุฉ
- โ ุตูุนุงุก ููููุฉ ุงูุชุฑุงุถูุฉ
- โ ูุต ุชูุถูุญู ูุฎุชูู ุญุณุจ ููุน ุงููุณุชุฎุฏู
- โ ููุญููุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ูุนูู ูู Create ู Update

**ุฌุงูุฒ ููุงุณุชุฎุฏุงู! ๐**

---

ุชุงุฑูุฎ ุงูุชุญุฏูุซ: 2025-10-29

